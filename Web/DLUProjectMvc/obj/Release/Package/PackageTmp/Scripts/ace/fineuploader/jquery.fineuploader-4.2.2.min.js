var qq=function(n){"use strict";return{hide:function(){return n.style.display="none",this},attach:function(t,i){return n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i),function(){qq(n).detach(t,i)}},detach:function(t,i){return n.removeEventListener?n.removeEventListener(t,i,!1):n.attachEvent&&n.detachEvent("on"+t,i),this},contains:function(t){return t?n===t?!0:n.contains?n.contains(t):!!(t.compareDocumentPosition(n)&8):!1},insertBefore:function(t){return t.parentNode.insertBefore(n,t),this},remove:function(){return n.parentNode.removeChild(n),this},css:function(t){if(n.style==null)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return t.opacity!=null&&typeof n.style.opacity!="string"&&typeof n.filters!="undefined"&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(n.style,t),this},hasClass:function(t){var i=new RegExp("(^| )"+t+"( |$)");return i.test(n.className)},addClass:function(t){return qq(n).hasClass(t)||(n.className+=" "+t),this},removeClass:function(t){var i=new RegExp("(^| )"+t+"( |$)");return n.className=n.className.replace(i," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){var i,r=[];return n.querySelectorAll?n.querySelectorAll("."+t):(i=n.getElementsByTagName("*"),qq.each(i,function(n,i){qq(i).hasClass(t)&&r.push(i)}),r)},children:function(){for(var i=[],t=n.firstChild;t;)t.nodeType===1&&i.push(t),t=t.nextSibling;return i},setText:function(t){return n.innerText=t,n.textContent=t,this},clearText:function(){return qq(n).setText("")},hasAttribute:function(t){var i;return n.hasAttribute?n.hasAttribute(t)?/^false$/i.exec(n.getAttribute(t))==null:!1:(i=n[t],i===undefined)?!1:/^false$/i.exec(i)==null}}};(function(){"use strict";qq.log=function(n,t){window.console&&(t&&t!=="info"?window.console[t]?window.console[t](n):window.console.log("<"+t+"> "+n):window.console.log(n))};qq.isObject=function(n){return n&&!n.nodeType&&Object.prototype.toString.call(n)==="[object Object]"};qq.isFunction=function(n){return typeof n=="function"};qq.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"||n&&window.ArrayBuffer&&n.buffer&&n.buffer.constructor===ArrayBuffer};qq.isItemList=function(n){return Object.prototype.toString.call(n)==="[object DataTransferItemList]"};qq.isNodeList=function(n){return Object.prototype.toString.call(n)==="[object NodeList]"||n.item&&n.namedItem};qq.isString=function(n){return Object.prototype.toString.call(n)==="[object String]"};qq.trimStr=function(n){return String.prototype.trim?n.trim():n.replace(/^\s+|\s+$/g,"")};qq.format=function(n){var r=Array.prototype.slice.call(arguments,1),t=n,i=t.indexOf("{}");return qq.each(r,function(n,r){var u=t.substring(0,i),f=t.substring(i+2);return t=u+r+f,i=t.indexOf("{}",i+r.length),i<0?!1:void 0}),t};qq.isFile=function(n){return window.File&&Object.prototype.toString.call(n)==="[object File]"};qq.isFileList=function(n){return window.FileList&&Object.prototype.toString.call(n)==="[object FileList]"};qq.isFileOrInput=function(n){return qq.isFile(n)||qq.isInput(n)};qq.isInput=function(n){return window.HTMLInputElement&&Object.prototype.toString.call(n)==="[object HTMLInputElement]"&&n.type&&n.type.toLowerCase()==="file"?!0:n.tagName&&n.tagName.toLowerCase()==="input"&&n.type&&n.type.toLowerCase()==="file"?!0:!1};qq.isBlob=function(n){return window.Blob&&Object.prototype.toString.call(n)==="[object Blob]"};qq.isXhrUploadSupported=function(){var n=document.createElement("input");return n.type="file",n.multiple!==undefined&&typeof File!="undefined"&&typeof FormData!="undefined"&&typeof qq.createXhrInstance().upload!="undefined"};qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(n){return qq.log("Neither XHR or ActiveX are supported!","error"),null}};qq.isFolderDropSupported=function(n){return n.items&&n.items[0].webkitGetAsEntry};qq.isFileChunkingSupported=function(){return!qq.android()&&qq.isXhrUploadSupported()&&(File.prototype.slice!==undefined||File.prototype.webkitSlice!==undefined||File.prototype.mozSlice!==undefined)};qq.sliceBlob=function(n,t,i){var r=n.slice||n.mozSlice||n.webkitSlice;return r.call(n,t,i)};qq.arrayBufferToHex=function(n){var t="",i=new Uint8Array(n);return qq.each(i,function(n,i){var r=i.toString(16);r.length<2&&(r="0"+r);t+=r}),t};qq.readBlobToHex=function(n,t,i){var f=qq.sliceBlob(n,t,t+i),r=new FileReader,u=new qq.Promise;return r.onload=function(){u.success(qq.arrayBufferToHex(r.result))},r.readAsArrayBuffer(f),u};qq.extend=function(n,t,i){return qq.each(t,function(t,r){i&&qq.isObject(r)?(n[t]===undefined&&(n[t]={}),qq.extend(n[t],r,!0)):n[t]=r}),n};qq.override=function(n,t){var i={},r=t(i);return qq.each(r,function(t,r){n[t]!==undefined&&(i[t]=n[t]);n[t]=r}),n};qq.indexOf=function(n,t,i){if(n.indexOf)return n.indexOf(t,i);i=i||0;var r=n.length;for(i<0&&(i+=r);i<r;i+=1)if(n.hasOwnProperty(i)&&n[i]===t)return i;return-1};qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})};qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!==-1};qq.ie7=function(){return navigator.userAgent.indexOf("MSIE 7")!==-1};qq.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!==-1};qq.ie11=function(){return navigator.userAgent.indexOf("Trident")!==-1&&navigator.userAgent.indexOf("rv:11")!==-1};qq.safari=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Apple")!==-1};qq.chrome=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Google")!==-1};qq.opera=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Opera")!==-1};qq.firefox=function(){return!qq.ie11()&&navigator.userAgent.indexOf("Mozilla")!==-1&&navigator.vendor!==undefined&&navigator.vendor===""};qq.windows=function(){return navigator.platform==="Win32"};qq.android=function(){return navigator.userAgent.toLowerCase().indexOf("android")!==-1};qq.ios7=function(){return qq.ios()&&navigator.userAgent.indexOf(" OS 7_")!==-1};qq.ios=function(){return navigator.userAgent.indexOf("iPad")!==-1||navigator.userAgent.indexOf("iPod")!==-1||navigator.userAgent.indexOf("iPhone")!==-1};qq.preventDefault=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1};qq.toElement=function(){var n=document.createElement("div");return function(t){n.innerHTML=t;var i=n.firstChild;return n.removeChild(i),i}}();qq.each=function(n,t){var i,r;if(n)if(window.Storage&&n.constructor===window.Storage){for(i=0;i<n.length;i++)if(r=t(n.key(i),n.getItem(n.key(i))),r===!1)break}else if(qq.isArray(n)||qq.isItemList(n)||qq.isNodeList(n)){for(i=0;i<n.length;i++)if(r=t(i,n[i]),r===!1)break}else if(qq.isString(n)){for(i=0;i<n.length;i++)if(r=t(i,n.charAt(i)),r===!1)break}else for(i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&(r=t(i,n[i]),r===!1))break};qq.bind=function(n,t){if(qq.isFunction(n)){var i=Array.prototype.slice.call(arguments,2);return function(){var r=qq.extend([],i);return arguments.length&&(r=r.concat(Array.prototype.slice.call(arguments))),n.apply(t,r)}}throw new Error("first parameter must be a function!");};qq.obj2url=function(n,t,i){var r=[],u="&",f=function(n,i){var u=t?/\[\]$/.test(t)?t:t+"["+i+"]":i;u!=="undefined"&&i!=="undefined"&&r.push(typeof n=="object"?qq.obj2url(n,u,!0):Object.prototype.toString.call(n)==="[object Function]"?encodeURIComponent(u)+"="+encodeURIComponent(n()):encodeURIComponent(u)+"="+encodeURIComponent(n))};return!i&&t?(u=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",r.push(t),r.push(qq.obj2url(n))):Object.prototype.toString.call(n)==="[object Array]"&&typeof n!="undefined"?qq.each(n,function(n,t){f(t,n)}):typeof n!="undefined"&&n!==null&&typeof n=="object"?qq.each(n,function(n,t){f(t,n)}):r.push(encodeURIComponent(t)+"="+encodeURIComponent(n)),t?r.join(u):r.join(u).replace(/^&/,"").replace(/%20/g,"+")};qq.obj2FormData=function(n,t,i){return t||(t=new FormData),qq.each(n,function(n,r){n=i?i+"["+n+"]":n;qq.isObject(r)?qq.obj2FormData(r,t,n):qq.isFunction(r)?t.append(n,r()):t.append(n,r)}),t};qq.obj2Inputs=function(n,t){var i;return t||(t=document.createElement("form")),qq.obj2FormData(n,{append:function(n,r){i=document.createElement("input");i.setAttribute("name",n);i.setAttribute("value",r);t.appendChild(i)}}),t};qq.setCookie=function(n,t,i){var r=new Date,u="";i&&(r.setTime(r.getTime()+i*864e5),u="; expires="+r.toGMTString());document.cookie=n+"="+t+u+"; path=/"};qq.getCookie=function(n){var t=n+"=",r=document.cookie.split(";"),i;return qq.each(r,function(n,r){for(var u=r;u.charAt(0)==" ";)u=u.substring(1,u.length);if(u.indexOf(t)===0)return i=u.substring(t.length,u.length),!1}),i};qq.getCookieNames=function(n){var i=document.cookie.split(";"),t=[];return qq.each(i,function(i,r){r=qq.trimStr(r);var u=r.indexOf("=");r.match(n)&&t.push(r.substr(0,u))}),t};qq.deleteCookie=function(n){qq.setCookie(n,"",-1)};qq.areCookiesEnabled=function(){var t=Math.random()*1e5,n="qqCookieTest:"+t;return(qq.setCookie(n,1),qq.getCookie(n))?(qq.deleteCookie(n),!0):!1};qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")};qq.getExtension=function(n){var t=n.lastIndexOf(".")+1;if(t>0)return n.substr(t,n.length-t)};qq.getFilename=function(n){return qq.isInput(n)?n.value.replace(/.*(\/|\\)/,""):qq.isFile(n)&&n.fileName!==null&&n.fileName!==undefined?n.fileName:n.name};qq.DisposeSupport=function(){var n=[];return{dispose:function(){var t;do t=n.shift(),t&&t();while(t)},attach:function(){var n=arguments;this.addDisposer(qq(n[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){n.push(t)}}}})(),function(){"use strict";qq.Error=function(n){this.message=n};qq.Error.prototype=new Error}();qq.version="4.2.2";qq.supportedFeatures=function(){"use strict";function y(){var t=!0,n;try{n=document.createElement("input");n.type="file";qq(n).hide();n.disabled&&(t=!1)}catch(i){t=!1}return t}function p(){return(qq.chrome()||qq.opera())&&navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/)!==undefined}function w(){return(qq.chrome()||qq.opera())&&navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/)!==undefined}function a(){if(window.XMLHttpRequest){var n=qq.createXhrInstance();return n.withCredentials!==undefined}return!1}function v(){return window.XDomainRequest!==undefined}function b(){return a()?!0:v()}function k(){return document.createElement("input").webkitdirectory!==undefined}var t,n,u,i,f,e,o,s,h,c,l,r;return t=y(),n=t&&qq.isXhrUploadSupported(),u=n&&p(),i=n&&qq.isFileChunkingSupported(),f=n&&i&&qq.areCookiesEnabled(),e=n&&w(),o=t&&(window.postMessage!==undefined||n),h=a(),s=v(),c=b(),l=k(),r=n&&window.FileReader!==undefined,{uploading:t,ajaxUploading:n,fileDrop:n,folderDrop:u,chunking:i,resume:f,uploadCustomHeaders:n,uploadNonMultipart:n,itemSizeValidation:n,uploadViaPaste:e,progressBar:n,uploadCors:o,deleteFileCorsXhr:h,deleteFileCorsXdr:s,deleteFileCors:c,canDetermineSize:n,folderSelection:l,imagePreviews:r,imageValidation:r,pause:i}}();qq.Promise=function(){"use strict";var t,n,u=[],f=[],i=[],r=0;qq.extend(this,{then:function(i,e){return r===0?(i&&u.push(i),e&&f.push(e)):r===-1?e&&e.apply(null,n):i&&i.apply(null,t),this},done:function(u){return r===0?i.push(u):u.apply(null,n===undefined?t:n),this},success:function(){return r=1,t=arguments,u.length&&qq.each(u,function(n,i){i.apply(null,t)}),i.length&&qq.each(i,function(n,i){i.apply(null,t)}),this},failure:function(){return r=-1,n=arguments,f.length&&qq.each(f,function(t,i){i.apply(null,n)}),i.length&&qq.each(i,function(t,i){i.apply(null,n)}),this}})};qq.UploadButton=function(n){"use strict";function f(){var n=document.createElement("input");return n.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,u),t.multiple&&n.setAttribute("multiple",""),t.folders&&qq.supportedFeatures.folderSelection&&n.setAttribute("webkitdirectory",""),t.acceptFiles&&n.setAttribute("accept",t.acceptFiles),n.setAttribute("type","file"),n.setAttribute("name",t.name),qq(n).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),t.element.appendChild(n),r.attach(n,"change",function(){t.onChange(n)}),r.attach(n,"mouseover",function(){qq(t.element).addClass(t.hoverClass)}),r.attach(n,"mouseout",function(){qq(t.element).removeClass(t.hoverClass)}),r.attach(n,"focus",function(){qq(t.element).addClass(t.focusClass)}),r.attach(n,"blur",function(){qq(t.element).removeClass(t.focusClass)}),window.attachEvent&&n.setAttribute("tabIndex","-1"),n}var r=new qq.DisposeSupport,t={element:null,multiple:!1,acceptFiles:null,folders:!1,name:"qqfile",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},i,u;qq.extend(t,n);u=qq.getUniqueId();qq(t.element).css({position:"relative",overflow:"hidden",direction:"ltr"});i=f();qq.extend(this,{getInput:function(){return i},getButtonId:function(){return u},setMultiple:function(n){n!==t.multiple&&(n?i.setAttribute("multiple",""):i.removeAttribute("multiple"))},setAcceptFiles:function(n){n!==t.acceptFiles&&i.setAttribute("accept",n)},reset:function(){i.parentNode&&qq(i).remove();qq(t.element).removeClass(t.focusClass);i=f()}})};qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id";qq.UploadData=function(n){"use strict";function u(n){if(qq.isArray(n)){var i=[];return qq.each(n,function(n,r){i.push(t[r])}),i}return t[n]}function f(n){if(qq.isArray(n)){var i=[];return qq.each(n,function(n,u){i.push(t[r[u]])}),i}return t[r[n]]}function e(n){var r=[],u=[].concat(n);return qq.each(u,function(n,u){var f=i[u];f!==undefined&&qq.each(f,function(n,i){r.push(t[i])})}),r}var t=[],r={},i={};qq.extend(this,{addFile:function(u,f,e,o){o=o||qq.status.SUBMITTING;var s=t.push({name:f,originalName:f,uuid:u,size:e,status:o})-1;t[s].id=s;r[u]=s;i[o]===undefined&&(i[o]=[]);i[o].push(s);n.onStatusChange(s,null,o);return s},retrieve:function(n){if(qq.isObject(n)&&t.length){if(n.id!==undefined)return u(n.id);if(n.uuid!==undefined)return f(n.uuid);if(n.status)return e(n.status)}else return qq.extend([],t,!0)},reset:function(){t=[];r={};i={}},setStatus:function(r,u){var f=t[r].status,e=qq.indexOf(i[f],r);i[f].splice(e,1);t[r].status=u;i[u]===undefined&&(i[u]=[]);i[u].push(r);n.onStatusChange(r,f,u)},uuidChanged:function(n,i){var u=t[n].uuid;t[n].uuid=i;r[i]=n;delete r[u]},updateName:function(n,i){t[n].name=i}})};qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={log:function(n,t){this._options.debug&&(!t||t==="info")?qq.log("[FineUploader "+qq.version+"] "+n):t&&t!=="info"&&qq.log("[FineUploader "+qq.version+"] "+n,t)},setParams:function(n,t){t==null?this._options.request.params=n:this._paramsStore.setParams(n,t)},setDeleteFileParams:function(n,t){t==null?this._options.deleteFile.params=n:this._deleteFileParamsStore.setParams(n,t)},setEndpoint:function(n,t){t==null?this._options.request.endpoint=n:this._endpointStore.setEndpoint(n,t)},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getNetUploads:function(){return this._netUploaded},uploadStoredFiles:function(){var n;if(this._storedIds.length===0)this._itemError("noFilesError");else while(this._storedIds.length)n=this._storedIds.shift(),this._uploadFile(n)},clearStoredFiles:function(){this._storedIds=[]},retry:function(n){return this._manualRetry(n)},cancel:function(n){this._handler.cancel(n)},cancelAll:function(){var n=[],t=this;qq.extend(n,this._storedIds);qq.each(n,function(n,i){t.cancel(i)});this._handler.cancelAll()},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];qq.each(this._buttons,function(n,t){t.reset()});this._paramsStore.reset();this._endpointStore.reset();this._netUploadedOrQueued=0;this._netUploaded=0;this._uploadData.reset();this._buttonIdsForFileIds=[];this._pasteHandler&&this._pasteHandler.reset();this._options.session.refreshOnReset&&this._refreshSessionData()},addFiles:function(n,t,i){var u=[],f,r,e;if(n){for(qq.isFileList(n)||(n=[].concat(n)),f=0;f<n.length;f+=1)if(r=n[f],qq.isFileOrInput(r))if(qq.isInput(r)&&qq.supportedFeatures.ajaxUploading)for(e=0;e<r.files.length;e++)this._handleNewFile(r.files[e],u);else this._handleNewFile(r,u);else this.log(r+" is not a File or INPUT element!  Ignoring!","warn");this.log("Received "+u.length+" files or inputs.");this._prepareItemsForUpload(u,t,i)}},addBlobs:function(n,t,i){if(n){var f=[].concat(n),u=[],r=this;qq.each(f,function(n,t){var i;qq.isBlob(t)&&!qq.isFileOrInput(t)?i={blob:t,name:r._options.blobs.defaultName}:qq.isObject(t)&&t.blob&&t.name?i=t:r.log("addBlobs: entry at index "+n+" is not a Blob or a BlobData object","error");i&&r._handleNewFile(i,u)});this._prepareItemsForUpload(u,t,i)}else this.log("undefined or non-array parameter passed into addBlobs","error")},getUuid:function(n){return this._uploadData.retrieve({id:n}).uuid},setUuid:function(n,t){return this._uploadData.uuidChanged(n,t)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(n){return this._uploadData.retrieve({id:n}).size},getName:function(n){return this._uploadData.retrieve({id:n}).name},setName:function(n,t){this._uploadData.updateName(n,t)},getFile:function(n){return this._handler.getFile(n)},deleteFile:function(n){this._onSubmitDelete(n)},setDeleteFileEndpoint:function(n,t){t==null?this._options.deleteFile.endpoint=n:this._deleteFileEndpointStore.setEndpoint(n,t)},doesExist:function(n){return this._handler.isValid(n)},getUploads:function(n){return this._uploadData.retrieve(n)},getButton:function(n){return this._getButton(this._buttonIdsForFileIds[n])},drawThumbnail:function(n,t,i,r){if(this._imageGenerator){var u=this._thumbnailUrls[n],f={scale:i>0,maxSize:i>0?i:null};return(!r&&qq.supportedFeatures.imagePreviews&&(u=this.getFile(n)),u==null)?(new qq.Promise).failure(t,"File or URL not found."):this._imageGenerator.generate(u,t,f)}},pauseUpload:function(n){var t=this._uploadData.retrieve({id:n});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],t.status)>=0){if(this._handler.pause(n))return this._uploadData.setStatus(n,qq.status.PAUSED),!0;qq.log(qq.format("Unable to pause file ID {} ({}).",n,this.getName(n)),"error")}else qq.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",n,this.getName(n)),"error");return!1},continueUpload:function(n){var t=this._uploadData.retrieve({id:n});return!qq.supportedFeatures.pause||!this._options.chunking.enabled?!1:t.status===qq.status.PAUSED?(qq.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",n,this.getName(n))),this._uploadFile(n),!0):(qq.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",n,this.getName(n)),"error"),!1)},getRemainingAllowedItems:function(){var n=this._options.validation.itemLimit;return n>0?this._options.validation.itemLimit-this._netUploadedOrQueued:null}};qq.basePrivateApi={_uploadFile:function(n){this._handler.upload(n)||this._uploadData.setStatus(n,qq.status.QUEUED)},_refreshSessionData:function(){var t=this,n=this._options.session;qq.Session&&this._options.session.endpoint!=null&&(this._session||(qq.extend(n,this._options.cors),n.log=qq.bind(this.log,this),n.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(n)),setTimeout(function(){t._session.refresh().then(function(n,i){t._options.callbacks.onSessionRequestComplete(n,!0,i)},function(n,i){t._options.callbacks.onSessionRequestComplete(n,!1,i)})},0))},_addCannedFile:function(n){var t=this._uploadData.addFile(n.uuid,n.name,n.size,qq.status.UPLOAD_SUCCESSFUL);return n.deleteFileEndpoint&&this.setDeleteFileEndpoint(n.deleteFileEndpoint,t),n.deleteFileParams&&this.setDeleteFileParams(n.deleteFileParams,t),n.thumbnailUrl&&(this._thumbnailUrls[t]=n.thumbnailUrl),this._netUploaded++,this._netUploadedOrQueued++,t},_handleNewFile:function(n,t){var i=-1,u=qq.getUniqueId(),f=qq.getFilename(n),r;n.size>=0?i=n.size:n.blob&&(i=n.blob.size);r=this._uploadData.addFile(u,f,i);this._handler.add(r,n);this._netUploadedOrQueued++;t.push({id:r,file:n})},_generateExtraButtonSpecs:function(){var n=this;this._extraButtonSpecs={};qq.each(this._options.extraButtons,function(t,i){var r=i.multiple,f=qq.extend({},n._options.validation,!0),u=qq.extend({},i);r===undefined&&(r=n._options.multiple);u.validation&&qq.extend(f,i.validation,!0);qq.extend(u,{multiple:r,validation:f},!0);n._initExtraButton(u)})},_initExtraButton:function(n){var t=this._createUploadButton({element:n.element,multiple:n.multiple,accept:n.validation.acceptFiles,folders:n.folders,allowedExtensions:n.validation.allowedExtensions});this._extraButtonSpecs[t.getButtonId()]=n},_getButtonId:function(n){var i,t;if(n&&!n.blob&&!qq.isBlob(n)){if(qq.isFile(n))return n.qqButtonId;if(n.tagName.toLowerCase()==="input"&&n.type.toLowerCase()==="file")return n.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(i=n.getElementsByTagName("input"),qq.each(i,function(n,i){if(i.getAttribute("type")==="file")return t=i,!1}),t)return t.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_annotateWithButtonId:function(n,t){qq.isFile(n)&&(n.qqButtonId=this._getButtonId(t))},_getButton:function(n){var t=this._extraButtonSpecs[n];return t?t.element:n===this._defaultButtonId?this._options.button:void 0},_handleCheckedCallback:function(n){var i=this,t=n.callback();if(t instanceof qq.Promise)return this.log(n.name+" - waiting for "+n.name+" promise to be fulfilled for "+n.identifier),t.then(function(t){i.log(n.name+" promise success for "+n.identifier);n.onSuccess(t)},function(){n.onFailure?(i.log(n.name+" promise failure for "+n.identifier),n.onFailure()):i.log(n.name+" promise failure for "+n.identifier)});if(t!==!1)n.onSuccess(t);else n.onFailure?(this.log(n.name+" - return value was 'false' for "+n.identifier+".  Invoking failure callback."),n.onFailure()):this.log(n.name+" - return value was 'false' for "+n.identifier+".  Will not proceed.");return t},_createUploadButton:function(n){function f(){return qq.supportedFeatures.ajaxUploading?qq.ios7()&&t._isAllowedExtension(u,".mov")?!1:n.multiple===undefined?t._options.multiple:n.multiple:!1}var t=this,r=n.accept||this._options.validation.acceptFiles,u=n.allowedExtensions||this._options.validation.allowedExtensions,i=new qq.UploadButton({element:n.element,folders:n.folders,name:this._options.request.inputName,multiple:f(),acceptFiles:r,onChange:function(n){t._onInputChange(n)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){i.dispose()}),t._buttons.push(i),i},_createUploadHandler:function(n,t){var i=this,r={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,demoMode:this._options.demoMode,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(i.log,i),onProgress:function(n,t,r,u){i._onProgress(n,t,r,u);i._options.callbacks.onProgress(n,t,r,u)},onComplete:function(n,t,r,u){var f=i._onComplete(n,t,r,u);if(f instanceof qq.Promise)f.done(function(){i._options.callbacks.onComplete(n,t,r,u)});else i._options.callbacks.onComplete(n,t,r,u)},onCancel:function(n,t){return i._handleCheckedCallback({name:"onCancel",callback:qq.bind(i._options.callbacks.onCancel,i,n,t),onSuccess:qq.bind(i._onCancel,i,n,t),identifier:n})},onUpload:function(n,t){i._onUpload(n,t);i._options.callbacks.onUpload(n,t)},onUploadChunk:function(n,t,r){i._onUploadChunk(n,r);i._options.callbacks.onUploadChunk(n,t,r)},onUploadChunkSuccess:function(){i._options.callbacks.onUploadChunkSuccess.apply(i,arguments)},onResume:function(n,t,r){return i._options.callbacks.onResume(n,t,r)},onAutoRetry:function(){return i._onAutoRetry.apply(i,arguments)},onUuidChanged:function(n,t){i.log("Server requested UUID change from '"+i.getUuid(n)+"' to '"+t+"'");i.setUuid(n,t)},getName:qq.bind(i.getName,i),getUuid:qq.bind(i.getUuid,i),getSize:qq.bind(i.getSize,i)};return qq.each(this._options.request,function(n,t){r[n]=t}),n&&qq.each(n,function(n,t){r[n]=t}),new qq.UploadHandler(r,t)},_createDeleteHandler:function(){var n=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:qq.bind(n.log,n),onDelete:function(t){n._onDelete(t);n._options.callbacks.onDelete(t)},onDeleteComplete:function(t,i,r){n._onDeleteComplete(t,i,r);n._options.callbacks.onDeleteComplete(t,i,r)}})},_createPasteHandler:function(){var n=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(n.log,n),pasteReceived:function(t){n._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(n._options.callbacks.onPasteReceived,n,t),onSuccess:qq.bind(n._handlePasteSuccess,n,t),identifier:"pasted image"})}}})},_createUploadDataTracker:function(){var n=this;return new qq.UploadData({getName:function(t){return n.getName(t)},getUuid:function(t){return n.getUuid(t)},getSize:function(t){return n.getSize(t)},onStatusChange:function(t,i,r){n._onUploadStatusChange(t,i,r);n._options.callbacks.onStatusChange(t,i,r)}})},_onUploadStatusChange:function(n,t,i){i===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[n])},_handlePasteSuccess:function(n,t){var r=n.type.split("/")[1],i=t;i==null&&(i=this._options.paste.defaultName);i+="."+r;this.addBlobs({name:i,blob:n})},_preventLeaveInProgress:function(){var n=this;this._disposeSupport.attach(window,"beforeunload",function(t){if(n.getInProgress())return t=t||window.event,t.returnValue=n._options.messages.onLeave,n._options.messages.onLeave})},_onSubmit:function(){},_onProgress:function(){},_onComplete:function(n,t,i,r){return i.success?(i.thumbnailUrl&&(this._thumbnailUrls[n]=i.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(n,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(n,qq.status.UPLOAD_FAILED)),this._maybeParseAndSendUploadError(n,t,i,r),i.success?!0:!1},_onCancel:function(n){this._netUploadedOrQueued--;clearTimeout(this._retryTimeouts[n]);var t=qq.indexOf(this._storedIds,n);!this._options.autoUpload&&t>=0&&this._storedIds.splice(t,1);this._uploadData.setStatus(n,qq.status.CANCELED)},_isDeletePossible:function(){return!qq.DeleteFileAjaxRequester||!this._options.deleteFile.enabled?!1:this._options.cors.expected?qq.supportedFeatures.deleteFileCorsXhr?!0:qq.supportedFeatures.deleteFileCorsXdr&&this._options.cors.allowXdr?!0:!1:!0},_onSubmitDelete:function(n,t,i){var r=this.getUuid(n),u;return t&&(u=qq.bind(t,this,n,r,i)),this._isDeletePossible()?this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,n),onSuccess:u||qq.bind(this._deleteHandler.sendDelete,this,n,r,i),identifier:n}):(this.log("Delete request ignored for ID "+n+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onDelete:function(n){this._uploadData.setStatus(n,qq.status.DELETING)},_onDeleteComplete:function(n,t,i){var r=this.getName(n);if(i)if(this._uploadData.setStatus(n,qq.status.DELETE_FAILED),this.log("Delete request for '"+r+"' has failed.","error"),t.withCredentials===undefined)this._options.callbacks.onError(n,r,"Delete request failed",t);else this._options.callbacks.onError(n,r,"Delete request failed with response code "+t.status,t);else this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(n),this._uploadData.setStatus(n,qq.status.DELETED),this.log("Delete request for '"+r+"' has succeeded.")},_onUpload:function(n){this._uploadData.setStatus(n,qq.status.UPLOADING)},_onUploadChunk:function(){},_onInputChange:function(n){var t;if(qq.supportedFeatures.ajaxUploading){for(t=0;t<n.files.length;t++)this._annotateWithButtonId(n.files[t],n);this.addFiles(n.files)}else n.value.length>0&&this.addFiles(n);qq.each(this._buttons,function(n,t){t.reset()})},_onBeforeAutoRetry:function(n,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onAutoRetry:function(n,t,i,r,u){var f=this;if(f._preventRetries[n]=i[f._options.retry.preventRetryResponseProperty],f._shouldAutoRetry(n,t,i)){f._maybeParseAndSendUploadError.apply(f,arguments);f._options.callbacks.onAutoRetry(n,t,f._autoRetries[n]+1);return f._onBeforeAutoRetry(n,t),f._retryTimeouts[n]=setTimeout(function(){f.log("Retrying "+t+"...");f._autoRetries[n]++;f._uploadData.setStatus(n,qq.status.UPLOAD_RETRYING);u?u(n):f._handler.retry(n)},f._options.retry.autoAttemptDelay*1e3),!0}},_shouldAutoRetry:function(n){var t=this._uploadData.retrieve({id:n});return!this._preventRetries[n]&&this._options.retry.enableAuto&&t.status!==qq.status.PAUSED?(this._autoRetries[n]===undefined&&(this._autoRetries[n]=0),this._autoRetries[n]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(n){var i=this._options.validation.itemLimit,t;return this._preventRetries[n]?(this.log("Retries are forbidden for id "+n,"warn"),!1):this._handler.isValid(n)?(t=this.getName(n),this._options.callbacks.onManualRetry(n,t)===!1)?!1:i>0&&this._netUploadedOrQueued+1>i?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+t+"' (id: "+n+")..."),!0):(this.log("'"+n+"' is not a valid file ID","error"),!1)},_manualRetry:function(n,t){if(this._onBeforeManualRetry(n))return this._netUploadedOrQueued++,this._uploadData.setStatus(n,qq.status.UPLOAD_RETRYING),t?t(n):this._handler.retry(n),!0},_maybeParseAndSendUploadError:function(n,t,i,r){if(!i.success)if(r&&r.status!==200&&!i.error)this._options.callbacks.onError(n,t,"XHR returned response code "+r.status,r);else{var u=i.error?i.error:this._options.text.defaultResponseError;this._options.callbacks.onError(n,t,u,r)}},_prepareItemsForUpload:function(n,t,i){var r=this._getValidationDescriptors(n),f=this._getButtonId(n[0].file),u=this._getButton(f);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,r,u),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,r,n,t,i,u),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,n),identifier:"batch validation"})},_upload:function(n,t,i){var r=this.getName(n);t&&this.setParams(t,n);i&&this.setEndpoint(i,n);this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,n,r),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,n,r),onFailure:qq.bind(this._fileOrBlobRejected,this,n,r),identifier:n})},_onSubmitCallbackSuccess:function(n){var t;t=qq.supportedFeatures.ajaxUploading?this._handler.getFile(n).qqButtonId:this._getButtonId(this._handler.getInput(n));t&&(this._buttonIdsForFileIds[n]=t);this._onSubmit.apply(this,arguments);this._uploadData.setStatus(n,qq.status.SUBMITTED);this._onSubmitted.apply(this,arguments);this._options.callbacks.onSubmitted.apply(this,arguments);this._options.autoUpload?this._uploadFile(n):this._storeForLater(n)},_onSubmitted:function(){},_storeForLater:function(n){this._storedIds.push(n)},_onValidateBatchCallbackSuccess:function(n,t,i,r,u){var e,f=this._options.validation.itemLimit,o=this._netUploadedOrQueued;f===0||o<=f?t.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,n[0],u),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,t,0,i,r),onFailure:qq.bind(this._onValidateCallbackFailure,this,t,0,i,r),identifier:"Item '"+t[0].file.name+"', size: "+t[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(t),e=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,o).replace(/\{itemLimit\}/g,f),this._batchError(e))},_onValidateBatchCallbackFailure:function(n){var t=this;qq.each(n,function(n,i){t._fileOrBlobRejected(i.id)})},_onValidateCallbackSuccess:function(n,t,i,r){var u=this,f=t+1,e=this._getValidationDescriptor(n[t].file);this._validateFileOrBlobData(n[t],e).then(function(){u._upload(n[t].id,i,r);u._maybeProcessNextItemAfterOnValidateCallback(!0,n,f,i,r)},function(){u._maybeProcessNextItemAfterOnValidateCallback(!1,n,f,i,r)})},_onValidateCallbackFailure:function(n,t,i,r){var u=t+1;this._fileOrBlobRejected(n[0].id,n[0].file.name);this._maybeProcessNextItemAfterOnValidateCallback(!1,n,u,i,r)},_maybeProcessNextItemAfterOnValidateCallback:function(n,t,i,r,u){var f=this;if(t.length>i)if(n||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var n=f._getValidationDescriptor(t[i].file);f._handleCheckedCallback({name:"onValidate",callback:qq.bind(f._options.callbacks.onValidate,f,t[i].file),onSuccess:qq.bind(f._onValidateCallbackSuccess,f,t,i,r,u),onFailure:qq.bind(f._onValidateCallbackFailure,f,t,i,r,u),identifier:"Item '"+n.name+"', size: "+n.size})},0);else if(!n)for(;i<t.length;i++)f._fileOrBlobRejected(t[i].id)},_validateFileOrBlobData:function(n,t){var o=this,i=n.file,u=t.name,f=t.size,s=this._getButtonId(i),e=this._getValidationBase(s),r=new qq.Promise;return(r.then(function(){},function(){o._fileOrBlobRejected(n.id,u)}),qq.isFileOrInput(i)&&!this._isAllowedExtension(e.allowedExtensions,u))?(this._itemError("typeError",u,i),r.failure()):f===0?(this._itemError("emptyError",u,i),r.failure()):f&&e.sizeLimit&&f>e.sizeLimit?(this._itemError("sizeError",u,i),r.failure()):f&&f<e.minSizeLimit?(this._itemError("minSizeError",u,i),r.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(i)?new qq.ImageValidation(i,qq.bind(o.log,o)).validate(e.image).then(r.success,function(n){o._itemError(n+"ImageError",u,i);r.failure()}):r.success(),r)},_fileOrBlobRejected:function(n){this._netUploadedOrQueued--;this._uploadData.setStatus(n,qq.status.REJECTED)},_itemError:function(n,t,i){function u(n,t){r=r.replace(n,t)}var r=this._options.messages[n],o=[],s=[].concat(t),h=s[0],l=this._getButtonId(i),f=this._getValidationBase(l),c,e;qq.each(f.allowedExtensions,function(n,t){qq.isString(t)&&o.push(t)});c=o.join(", ").toLowerCase();u("{file}",this._options.formatFileName(h));u("{extensions}",c);u("{sizeLimit}",this._formatSize(f.sizeLimit));u("{minSizeLimit}",this._formatSize(f.minSizeLimit));e=r.match(/(\{\w+\})/g);e!==null&&qq.each(e,function(n,t){u(t,s[n])});this._options.callbacks.onError(null,h,r,undefined);return r},_batchError:function(n){this._options.callbacks.onError(null,null,n,undefined)},_isAllowedExtension:function(n,t){var i=!1;return n.length?(qq.each(n,function(n,r){if(qq.isString(r)){var u=new RegExp("\\."+r+"$","i");if(t.match(u)!=null)return i=!0,!1}}),i):!0},_formatSize:function(n){var t=-1;do n=n/1e3,t++;while(n>999);return Math.max(n,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_wrapCallbacks:function(){var n,t,i;n=this;t=function(t,i,r){var u;try{return i.apply(n,r)}catch(f){u=f.message||f.toString();n.log("Caught exception in '"+t+"' callback - "+u,"error")}};for(i in this._options.callbacks)(function(){var r,u;r=i;u=n._options.callbacks[r];n._options.callbacks[r]=function(){return t(r,u,arguments)}})()},_parseFileOrBlobDataName:function(n){return qq.isFileOrInput(n)?n.value?n.value.replace(/.*(\/|\\)/,""):n.fileName!==null&&n.fileName!==undefined?n.fileName:n.name:n.name},_parseFileOrBlobDataSize:function(n){var t;return qq.isFileOrInput(n)?n.value===undefined&&(t=n.fileSize!==null&&n.fileSize!==undefined?n.fileSize:n.size):t=n.blob.size,t},_getValidationDescriptor:function(n){var t={},r=this._parseFileOrBlobDataName(n),i=this._parseFileOrBlobDataSize(n);return t.name=r,i!==undefined&&(t.size=i),t},_getValidationDescriptors:function(n){var i=this,t=[];return qq.each(n,function(n,r){t.push(i._getValidationDescriptor(r.file))}),t},_createParamsStore:function(n){var t={},i=this;return{setParams:function(n,i){var r={};qq.extend(r,n);t[i]=r},getParams:function(r){var u={};return r!=null&&t[r]?qq.extend(u,t[r]):qq.extend(u,i._options[n].params),u},remove:function(n){return delete t[n]},reset:function(){t={}}}},_createEndpointStore:function(n){var t={},i=this;return{setEndpoint:function(n,i){t[i]=n},getEndpoint:function(r){return r!=null&&t[r]?t[r]:i._options[n].endpoint},remove:function(n){return delete t[n]},reset:function(){t={}}}},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var i="image/*;capture=camera",r=this._options.camera.button,t=r?this._getButtonId(r):this._defaultButtonId,n=this._options;t&&t!==this._defaultButtonId&&(n=this._extraButtonSpecs[t]);n.multiple=!1;n.validation.acceptFiles===null?n.validation.acceptFiles=i:n.validation.acceptFiles+=","+i;qq.each(this._buttons,function(i,r){if(r.getButtonId()===t)return r.setMultiple(n.multiple),r.setAcceptFiles(n.acceptFiles),!1})}},_getValidationBase:function(n){var t=this._extraButtonSpecs[n];return t?t.validation:this._options.validation}}}(),function(){"use strict";qq.FineUploaderBasic=function(n){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",filenameParam:"qqfilename"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0}},callbacks:{onSubmit:function(){},onSubmitted:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onResume:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){},onPasteReceived:function(){},onStatusChange:function(){},onSessionRequestComplete:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(n){return n!==undefined&&n.length>33&&(n=n.slice(0,19)+"..."+n.slice(-14)),n},text:{defaultResponseError:"Upload failure reason unknown",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0}};qq.extend(this._options,n,!0);this._buttons=[];this._extraButtonSpecs={};this._buttonIdsForFileIds=[];this._wrapCallbacks();this._disposeSupport=new qq.DisposeSupport;this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];this._netUploadedOrQueued=0;this._netUploaded=0;this._uploadData=this._createUploadDataTracker();this._paramsStore=this._createParamsStore("request");this._deleteFileParamsStore=this._createParamsStore("deleteFile");this._endpointStore=this._createEndpointStore("request");this._deleteFileEndpointStore=this._createEndpointStore("deleteFile");this._handler=this._createUploadHandler();this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler();this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button}).getButtonId());this._generateExtraButtonSpecs();this._handleCameraAccess();this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():qq.log("Paste support module not found","info"));this._preventLeaveInProgress();this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this));this._refreshSessionData()};qq.FineUploaderBasic.prototype=qq.basePublicApi;qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}();qq.AjaxRequester=function(n){"use strict";function c(){return qq.indexOf(["GET","POST","HEAD"],t.method)>=0}function l(){var n=!1;return qq.each(n,function(t,i){if(qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],i)<0)return n=!0,!1}),n}function f(n){return t.cors.expected&&n.withCredentials===undefined}function a(){var n;return(window.XMLHttpRequest||window.ActiveXObject)&&(n=qq.createXhrInstance(),n.withCredentials===undefined&&(n=new XDomainRequest)),n}function e(n,r){var u=i[n].xhr;return u||r||(u=t.cors.expected?a():qq.createXhrInstance(),i[n].xhr=u),u}function v(n){var f=qq.indexOf(r,n),u=t.maxConnections,e;delete i[n];r.splice(f,1);r.length>=u&&f<u&&(e=r[u-1],h(e))}function s(n,i){var r=e(n),s=t.method,o=i===!0;v(n);o?u(s+" request for "+n+" has failed","error"):f(r)||g(r.status)||(o=!0,u(s+" request for "+n+" has failed - response code "+r.status,"error"));t.onComplete(n,r,o)}function y(n){var u=i[n].additionalParams,f=t.mandatedParams,r;return t.paramsStore.getParams&&(r=t.paramsStore.getParams(n)),u&&qq.each(u,function(n,t){r=r||{};r[n]=t}),f&&qq.each(f,function(n,t){r=r||{};r[n]=t}),r}function h(n){var r=e(n),h=t.method,s=y(n),c=i[n].payload,l;t.onSend(n);l=p(n,s);f(r)?(r.onload=b(n),r.onerror=k(n)):r.onreadystatechange=w(n);r.open(h,l,!0);t.cors.expected&&t.cors.sendCredentials&&!f(r)&&(r.withCredentials=!0);d(n);u("Sending "+h+" request for "+n);c?r.send(c):o||!s?r.send():s&&t.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?r.send(qq.obj2url(s,"")):s&&t.contentType.toLowerCase().indexOf("application/json")>=0?r.send(JSON.stringify(s)):r.send(s)}function p(n,r){var u=t.endpointStore.getEndpoint(n),f=i[n].addToPath;return f!=undefined&&(u+="/"+f),o&&r?qq.obj2url(r,u):u}function w(n){return function(){e(n).readyState===4&&s(n)}}function b(n){return function(){s(n)}}function k(n){return function(){s(n,!0)}}function d(n){var r=e(n),o=t.customHeaders,h=i[n].additionalHeaders||{},s=t.method,u={};f(r)||(t.allowXRequestedWithAndCacheControl&&(t.cors.expected&&c()&&!l(o)||(r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Cache-Control","no-cache"))),t.contentType&&(s==="POST"||s==="PUT")&&r.setRequestHeader("Content-Type",t.contentType),qq.extend(u,o),qq.extend(u,h),qq.each(u,function(n,t){r.setRequestHeader(n,t)}))}function g(n){return qq.indexOf(t.successfulResponseCodes[t.method],n)>=0}function nt(n,u,f,e,o){i[n]={addToPath:u,additionalParams:f,additionalHeaders:e,payload:o};var s=r.push(n);s<=t.maxConnections&&h(n)}var u,o,r=[],i=[],t={validMethods:["POST"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],POST:[200,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){}};if(qq.extend(t,n),u=t.log,qq.indexOf(t.validMethods,t.method)<0)throw new Error("'"+t.method+"' is not a supported method for this type of request!");o=t.method==="GET"||t.method==="DELETE";qq.extend(this,{initTransport:function(n){var t,i,r,u;return{withPath:function(n){return t=n,this},withParams:function(n){return i=n,this},withHeaders:function(n){return r=n,this},withPayload:function(n){return u=n,this},send:function(){nt(n,t,i,r,u)}}}})};qq.UploadHandler=function(n,t){"use strict";function e(n){var t=qq.indexOf(u,n),f=r.maxConnections,e;t>=0&&(u.splice(t,1),u.length>=f&&t<f&&(e=u[f-1],i.upload(e)))}function o(n){f("Cancelling "+n);r.paramsStore.remove(n);e(n)}function s(){var n=t?qq[t]:qq,u=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";i=new n["UploadHandler"+u](r,{onUploadComplete:e,onUuidChanged:r.onUuidChanged,getName:r.getName,getUuid:r.getUuid,getSize:r.getSize,log:f})}var u=[],r,f,i;r={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},filenameParam:"qqfilename",cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onAutoRetry:function(){},onResume:function(){},onUuidChanged:function(){},getName:function(){}};qq.extend(r,n);f=r.log;qq.extend(this,{add:function(){return i.add.apply(this,arguments)},upload:function(n){var t=u.push(n);return t<=r.maxConnections?(i.upload(n),!0):!1},retry:function(n){var t=qq.indexOf(u,n);return t>=0?i.upload(n,!0):this.upload(n)},cancel:function(n){var t=i.cancel(n);t instanceof qq.Promise?t.then(function(){o(n)}):t!==!1&&o(n)},cancelAll:function(){var t=this,n=[];qq.extend(n,u);qq.each(n,function(n,i){t.cancel(i)});u=[]},getFile:function(n){if(i.getFile)return i.getFile(n)},getInput:function(n){if(i.getInput)return i.getInput(n)},reset:function(){f("Resetting upload handler");this.cancelAll();u=[];i.reset()},expunge:function(n){if(this.isValid(n))return i.expunge(n)},isValid:function(n){return i.isValid(n)},getResumableFilesData:function(){return i.getResumableFilesData?i.getResumableFilesData():[]},getThirdPartyFileId:function(n){if(i.getThirdPartyFileId&&this.isValid(n))return i.getThirdPartyFileId(n)},pause:function(n){if(i.pause&&this.isValid(n)&&i.pause(n))return e(n),!0}});s()};qq.UploadHandlerFormApi=function(n,t,i){"use strict";function b(t){delete f[t];delete u[t];h&&(clearTimeout(e[t]),delete e[t],s.stopReceivingMessages(t));var i=document.getElementById(n.getIframeName(t));i&&(i.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(i).remove())}function k(t,i){var h=t.id,l=c(h),a=w(l);o[a]=i;f[l]=qq(t).attach("load",function(){u[l].input&&(r("Received iframe load event for CORS upload request (iframe name "+h+")"),e[h]=setTimeout(function(){var n="No valid message received from loaded iframe for iframe name "+h;r(n,"error");i({error:n})},1e3))});s.receiveMessage(h,function(t){r("Received the following window message: '"+t+"'");var l=c(h),u=n.parseJsonResponse(l,t),i=u.uuid,f;i&&o[i]?(r("Handling response for iframe name "+h),clearTimeout(e[h]),delete e[h],n.detachLoadEvent(h),f=o[i],delete o[i],s.stopReceivingMessages(h),f(u)):i||r("'"+t+"' does not contain a UUID - ignoring.")})}function d(n){var t=qq.toElement("<iframe src='javascript:false;' name='"+n+"' />");return t.setAttribute("id",n),t.style.display="none",document.body.appendChild(t),t}function c(n){return n.split("_")[0]}var l=qq.getUniqueId(),o={},f={},e={},g=this,h=t.isCors,u=t.fileState,a=t.inputName,v=i.onCancel,y=i.onUuidChanged,p=i.getName,w=i.getUuid,r=i.log,s=new qq.WindowReceiveMessage({log:r});qq.extend(n,{getIframeName:function(n){return n+"_"+l},createIframe:function(t){var i=n.getIframeName(t);return d(i)},parseJsonResponse:function(n,t){var i;try{i=qq.parseJson(t);i.newUuid!==undefined&&y(n,i.newUuid)}catch(u){r("Error when attempting to parse iframe upload response ("+u.message+")","error");i={}}return i},initFormForUpload:function(n){var f=n.method,i=n.endpoint,r=n.params,e=n.paramsInBody,o=n.targetName,t=qq.toElement("<form method='"+f+"' enctype='multipart/form-data'><\/form>"),u=i;return e?qq.obj2Inputs(r,t):u=qq.obj2url(r,i),t.setAttribute("action",u),t.setAttribute("target",o),t.style.display="none",document.body.appendChild(t),t},attachLoadEvent:function(n,t){var i;h?k(n,t):f[n.id]=qq(n).attach("load",function(){if(r("Received response for "+n.id),n.parentNode){try{if(n.contentDocument&&n.contentDocument.body&&n.contentDocument.body.innerHTML=="false")return}catch(u){r("Error when attempting to access iframe during handling of upload response ("+u.message+")","error");i={success:!1}}t(i)}})},detachLoadEvent:function(n){f[n]!==undefined&&(f[n](),delete f[n])}});qq.extend(this,{add:function(n,t){u[n]={input:t};t.setAttribute("name",a);t.parentNode&&qq(t).remove()},getInput:function(n){return u[n].input},isValid:function(n){return u[n]!==undefined&&u[n].input!==undefined},reset:function(){u.length=0},expunge:function(n){return b(n)},cancel:function(n){var t=v(n,p(n));return t instanceof qq.Promise?t.then(function(){this.expunge(n)}):t!==!1?(this.expunge(n),!0):!1},upload:function(){}})};qq.UploadHandlerXhrApi=function(n,t,i){"use strict";function l(n,t,i){return n.slice?n.slice(t,i):n.mozSlice?n.mozSlice(t,i):n.webkitSlice?n.webkitSlice(t,i):void 0}var o=this,r=t.fileState,u=t.chunking,s=i.onUpload,h=i.onCancel,a=i.onUuidChanged,f=i.getName,e=i.getSize,c=i.log;qq.extend(n,{createXhr:function(n){var t=qq.createXhrInstance();return r[n].xhr=t,t},getTotalChunks:function(n){if(u){var t=e(n),i=u.partSize;return Math.ceil(t/i)}},getChunkData:function(t,i){var f=u.partSize,h=e(t),c=o.getFile(t),r=f*i,s=r+f>=h?h:r+f,a=n.getTotalChunks(t);return{part:i,start:r,end:s,count:a,blob:l(c,r,s),size:s-r}},getChunkDataForCallback:function(n){return{partIndex:n.part,startByte:n.start+1,endByte:n.end,totalParts:n.count}}});qq.extend(this,{add:function(n,t){if(qq.isFile(t))r[n]={file:t};else if(qq.isBlob(t.blob))r[n]={blobData:t};else throw new Error("Passed obj is not a File or BlobData (in qq.UploadHandlerXhr)");},getFile:function(n){if(r[n])return r[n].file||r[n].blobData.blob},isValid:function(n){return r[n]!==undefined},reset:function(){r.length=0},expunge:function(n){var t=r[n].xhr;t&&(t.onreadystatechange=null,t.abort());delete r[n]},upload:function(n,t){return r[n]&&delete r[n].paused,s(n,t)},cancel:function(n){var t=h(n,f(n));return t instanceof qq.Promise?t.then(function(){this.expunge(n)}):t!==!1?(this.expunge(n),!0):!1},pause:function(n){var t=r[n].xhr;if(t)return c(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",n,f(n))),r[n].paused=!0,t.abort(),!0}})};qq.WindowReceiveMessage=function(n){"use strict";var i={log:function(){}},t={};qq.extend(i,n);qq.extend(this,{receiveMessage:function(n,i){var r=function(n){i(n.data)};window.postMessage?t[n]=qq(window).attach("message",r):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(n){if(window.postMessage){var i=t[n];i&&i()}}})},function(){"use strict";qq.uiPublicApi={clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments);this._templating.clearFiles()},addExtraDropzone:function(n){this._dnd&&this._dnd.setupExtraDropzone(n)},removeExtraDropzone:function(n){if(this._dnd)return this._dnd.removeDropzone(n)},getItemByFileId:function(n){return this._templating.getFileContainer(n)},reset:function(){this._parent.prototype.reset.apply(this,arguments);this._templating.reset();!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId());this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop());this._totalFilesInBatch=0;this._filesInBatchAddedToUi=0;this._setupClickAndEditEventHandlers()},pauseUpload:function(n){var t=this._parent.prototype.pauseUpload.apply(this,arguments);return t&&this._templating.uploadPaused(n),t},continueUpload:function(n){var t=this._parent.prototype.continueUpload.apply(this,arguments);return t&&this._templating.uploadContinued(n),t},getId:function(n){return this._templating.getFileId(n)},getDropTarget:function(n){var t=this.getFile(n);return t.qqDropTarget}};qq.uiPrivateApi={_getButton:function(n){var t=this._parent.prototype._getButton.apply(this,arguments);return t||n===this._defaultButtonId&&(t=this._templating.getButton()),t},_removeFileItem:function(n){this._templating.removeFile(n)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent();this._focusinEventSupported=!qq.firefox();this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var n=this,i=this._options.dragAndDrop.extraDropzones,t=this._templating,r=t.getDropZone();return r&&i.push(r),new qq.DragAndDrop({dropZoneElements:i,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){t.showDropProcessing()},processingDroppedFilesComplete:function(i,r){t.hideDropProcessing();qq.each(i,function(n,t){t.qqDropTarget=r});i&&n.addFiles(i,null,null)},dropError:function(t,i){n._itemError(t,i)},dropLog:function(t,i){n.log(t,i)}}})},_bindFileButtonsClickEvent:function(){var n=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(t,i){n.log(t,i)},onDeleteFile:function(t){n.deleteFile(t)},onCancel:function(t){n.cancel(t)},onRetry:function(t){qq(n._templating.getFileContainer(t)).removeClass(n._classes.retryable);n.retry(t)},onPause:function(t){n.pauseUpload(t)},onContinue:function(t){n.continueUpload(t)},onGetName:function(t){return n.getName(t)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var t=this,n=this._templating;return{templating:n,log:function(n,i){t.log(n,i)},onGetUploadStatus:function(n){return t.getUploads({id:n}).status},onGetName:function(n){return t.getName(n)},onSetName:function(i,r){var u=t._options.formatFileName(r);n.updateFilename(i,u);t.setName(i,r)},onEditingStatusChange:function(t,i){var r=qq(n.getEditInput(t)),u=qq(n.getFileContainer(t));i?(r.addClass("qq-editing"),n.hideFilename(t),n.hideEditIcon(t)):(r.removeClass("qq-editing"),n.showFilename(t),n.showEditIcon(t));u.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(n,t,i){this._parent.prototype._onUploadStatusChange.apply(this,arguments);this._isEditFilenameEnabled()&&this._templating.getFileContainer(n)&&i!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(n),this._templating.hideEditIcon(n))},_bindFilenameInputFocusInEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(n)},_bindFilenameInputFocusEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(n)},_bindFilenameClickEvent:function(){var n=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(n)},_storeForLater:function(n){this._parent.prototype._storeForLater.apply(this,arguments);this._templating.hideSpinner(n)},_onSubmit:function(n,t){this._parent.prototype._onSubmit.apply(this,arguments);this._addToList(n,t)},_onSubmitted:function(n){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(n),this._templating.showEditIcon(n),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(n)))},_onProgress:function(n,t,i,r){this._parent.prototype._onProgress.apply(this,arguments);this._templating.updateProgress(n,i,r);i===r?(this._templating.hideCancel(n),this._templating.hidePause(n),this._templating.setStatusText(n,this._options.text.waitingForResponse),this._displayFileSize(n)):this._displayFileSize(n,i,r)},_onComplete:function(n,t,i){function e(t){u.setStatusText(n);qq(u.getFileContainer(n)).removeClass(r._classes.retrying);u.hideProgress(n);(!r._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&u.hideCancel(n);u.hideSpinner(n);t.success?r._markFileAsSuccessful(n):(qq(u.getFileContainer(n)).addClass(r._classes.fail),r._templating.isRetryPossible()&&!r._preventRetries[n]&&qq(u.getFileContainer(n)).addClass(r._classes.retryable),r._controlFailureTextDisplay(n,t))}var f=this._parent.prototype._onComplete.apply(this,arguments),u=this._templating,r=this;return f instanceof qq.Promise?f.done(function(n){e(n)}):e(i),f},_markFileAsSuccessful:function(n){var t=this._templating;this._isDeletePossible()&&t.showDeleteButton(n);qq(t.getFileContainer(n)).addClass(this._classes.success);this._maybeUpdateThumbnail(n)},_onUpload:function(n){var t=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(n),t},_onUploadChunk:function(n,t){this._parent.prototype._onUploadChunk.apply(this,arguments);t.partIndex>0&&this._templating.allowPause(n)},_onCancel:function(n){this._parent.prototype._onCancel.apply(this,arguments);this._removeFileItem(n)},_onBeforeAutoRetry:function(n){var i,r,t;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments);this._showCancelLink(n);this._options.retry.showAutoRetryNote&&(i=this._autoRetries[n]+1,r=this._options.retry.maxAutoAttempts,t=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,i),t=t.replace(/\{maxAuto\}/g,r),this._templating.setStatusText(n,t),qq(this._templating.getFileContainer(n)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(n){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(n),qq(this._templating.getFileContainer(n)).removeClass(this._classes.fail),this._templating.setStatusText(n),this._templating.showSpinner(n),this._showCancelLink(n),!0):(qq(this._templating.getFileContainer(n)).addClass(this._classes.retryable),!1)},_onSubmitDelete:function(n){var t=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,n,t)},_onSubmitDeleteSuccess:function(){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(n,t,i){this._parent.prototype._onDeleteComplete.apply(this,arguments);this._templating.hideSpinner(n);i?(this._templating.setStatusText(n,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(n)):this._removeFileItem(n)},_sendDeleteRequest:function(n){this._templating.hideDeleteButton(n);this._templating.showSpinner(n);this._templating.setStatusText(n,this._options.deleteFile.deletingStatusText);this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(n){var u=this.getName(n),f=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,u),uuid=this.getUuid(n),r=arguments,t=this,i;i=this._options.showConfirm(f);i instanceof qq.Promise?i.then(function(){t._sendDeleteRequest.apply(t,r)}):i!==!1&&t._sendDeleteRequest.apply(t,r)},_addToList:function(n,t,i){var r,u=0;this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(u=this._filesInBatchAddedToUi-1),r={index:u});i||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(this._handler.cancelAll(),this._clearList()));this._templating.addFile(n,this._options.formatFileName(t),r);i?this._thumbnailUrls[n]&&this._templating.updateThumbnail(n,this._thumbnailUrls[n],!0):this._templating.generatePreview(n,this.getFile(n));this._filesInBatchAddedToUi+=1;this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading&&this._displayFileSize(n)},_clearList:function(){this._templating.clearFiles();this.clearStoredFiles()},_displayFileSize:function(n,t,i){var r=this.getSize(n),u=this._formatSize(r);r>=0&&(t!==undefined&&i!==undefined&&(u=this._formatProgress(t,i)),this._templating.updateSize(n,u))},_formatProgress:function(n,t){function r(n,t){i=i.replace(n,t)}var i=this._options.text.formatProgress;return r("{percent}",Math.round(n/t*100)),r("{total_size}",this._formatSize(t)),i},_controlFailureTextDisplay:function(n,t){var r,u,f,i,e;r=this._options.failedUploadTextDisplay.mode;u=this._options.failedUploadTextDisplay.maxChars;f=this._options.failedUploadTextDisplay.responseProperty;r==="custom"?(i=t[f],i?i.length>u&&(e=i.substring(0,u)+"..."):(i=this._options.text.failUpload,this.log("'"+f+"' is not a valid property on the server response.","warn")),this._templating.setStatusText(n,e||i),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(n,i)):r==="default"?this._templating.setStatusText(n,this._options.text.failUpload):r!=="none"&&this.log("failedUploadTextDisplay.mode value of '"+r+"' is not valid","warn")},_showTooltip:function(n,t){this._templating.getFileContainer(n).title=t},_showCancelLink:function(n){(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&this._templating.showCancel(n)},_itemError:function(){var n=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(n)},_batchError:function(n){this._parent.prototype._batchError.apply(this,arguments);this._options.showMessage(n)},_setupPastePrompt:function(){var n=this;this._options.callbacks.onPasteReceived=function(){var t=n._options.paste.namePromptMessage,i=n._options.paste.defaultName;return n._options.showPrompt(t,i)}},_fileOrBlobRejected:function(){this._totalFilesInBatch-=1;this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(n){this._totalFilesInBatch=n.length;this._filesInBatchAddedToUi=0;this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(n){var t=this._thumbnailUrls[n];this._templating.updateThumbnail(n,t)},_addCannedFile:function(){var n=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(n,this.getName(n),!0),this._templating.hideSpinner(n),this._templating.hideCancel(n),this._markFileAsSuccessful(n),n}}}();qq.FineUploader=function(n,t){"use strict";this._parent=t?qq[t].FineUploaderBasic:qq.FineUploaderBasic;this._parent.apply(this,arguments);qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[]},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null}},showMessage:function(n){setTimeout(function(){window.alert(n)},0)},showConfirm:function(n){return window.confirm(n)},showPrompt:function(n,t){return window.prompt(n,t)}},!0);qq.extend(this._options,n,!0);this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text});qq.supportedFeatures.uploading&&(!this._options.cors.expected||qq.supportedFeatures.uploadCors)?(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():qq.log("Paste support module not found.","info")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0):this._templating.renderFailure(this._options.messages.unsupportedBrowser)};qq.extend(qq.FineUploader.prototype,qq.basePublicApi);qq.extend(qq.FineUploader.prototype,qq.basePrivateApi);qq.extend(qq.FineUploader.prototype,qq.uiPublicApi);qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi);qq.Templating=function(n){"use strict";function dt(){var o,f,e,n,v,c,u,r,l;if(h("Parsing template"),i.templateIdOrEl==null)throw new Error("You MUST specify either a template element or ID!");if(qq.isString(i.templateIdOrEl)){if(o=document.getElementById(i.templateIdOrEl),o===null)throw new Error(qq.format("Cannot find template script at ID '{}'!",i.templateIdOrEl));f=o.innerHTML}else{if(i.templateIdOrEl.innerHTML===undefined)throw new Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");f=i.templateIdOrEl.innerHTML}if(f=qq.trimStr(f),n=document.createElement("div"),n.appendChild(qq.toElement(f)),i.button&&(c=qq(n).getByClass(t.button)[0],c&&qq(c).remove()),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(l=qq(n).getByClass(t.dropProcessing)[0],l&&qq(l).remove()),u=qq(n).getByClass(t.drop)[0],u&&!qq.DragAndDrop&&(qq.log("DnD module unavailable.","info"),qq(u).remove()),u&&!qq.supportedFeatures.fileDrop&&qq(u).hasAttribute(kt)&&qq(u).css({display:"none"}),r=qq(n).getByClass(t.thumbnail)[0],a?r&&(s=parseInt(r.getAttribute(wt)),s=s>0?s:null,tt=qq(r).hasAttribute(bt)):r&&qq(r).remove(),a=a&&r,st=qq(n).getByClass(t.editFilenameInput).length>0,ht=qq(n).getByClass(t.retry).length>0,e=qq(n).getByClass(t.list)[0],e==null)throw new Error("Could not find the file list container in the template!");return v=e.innerHTML,e.innerHTML="",h("Template parsing complete"),{template:qq.trimStr(n.innerHTML),fileTemplate:qq.trimStr(v)}}function f(n){return qq(l).getByClass(ot+n)[0]}function r(n,t){return qq(n).getByClass(t)[0]}function gt(n,t){var i=l,r=i.firstChild;t>0&&(r=qq(i).children()[t].nextSibling);i.insertBefore(n,r)}function ct(n){return r(f(n),t.cancel)}function p(n){return r(f(n),t.pause)}function it(n){return r(f(n),t.continueButton)}function w(n){return r(f(n),t.progressBarContainer)||r(f(n),t.progressBar)}function b(n){return r(f(n),t.spinner)}function lt(n){return r(f(n),t.editNameIcon)}function at(n){return r(f(n),t.size)}function rt(n){return r(f(n),t.deleteButton)}function ni(n){return r(f(n),t.retry)}function k(n){return r(f(n),t.file)}function ut(){return r(o,t.dropProcessing)}function vt(n){return a&&r(f(n),t.thumbnail)}function u(n){n&&qq(n).addClass(i.classes.hide)}function e(n){n&&qq(n).removeClass(i.classes.hide)}function yt(n,i){var r=w(n);r&&!qq(r).hasClass(t.progressBar)&&(r=qq(r).getByClass(t.progressBar)[0]);r&&qq(r).css({width:i+"%"})}function ti(){var n=i.placeholders.thumbnailNotAvailable,t=i.placeholders.waitingForThumbnail,r={maxSize:s,scale:tt};a&&(n?i.imageGenerator.generate(n,new Image,r).then(function(n){v.success(n)},function(){v.failure();h("Problem loading 'not available' placeholder image at "+n,"error")}):v.failure(),t?i.imageGenerator.generate(t,new Image,r).then(function(n){y.success(n)},function(){y.failure();h("Problem loading 'waiting for thumbnail' placeholder image at "+t,"error")}):y.failure())}function ft(n){y.then(function(t){pt(t,n);n.getAttribute("src")==null&&(n.src=t.src,e(n))},function(){u(n)})}function et(n,t){var i=c[n]||(new qq.Promise).failure();v.then(function(r){i.then(function(){delete c[n]},function(){pt(r,t);t.src=r.src;e(t);delete c[n]})})}function pt(n,t){var i=n.style.maxWidth,r=n.style.maxHeight;r&&i&&!t.style.maxWidth&&!t.style.maxHeight&&qq(t).css({maxWidth:i,maxHeight:r})}var d="qq-file-id",ot="qq-file-id-",wt="qq-max-size",bt="qq-server-scale",kt="qq-hide-dropzone",g=!1,s=-1,i={log:null,templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},t={button:"qq-upload-button-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},c={},v=new qq.Promise,y=new qq.Promise,h,st,ht,nt,o,l,a,tt;qq.extend(i,n);h=i.log;o=i.containerEl;a=i.imageGenerator!==undefined;nt=dt();ti();qq.extend(this,{render:function(){h("Rendering template in DOM.");o.innerHTML=nt.template;u(ut());l=i.fileContainerEl||r(o,t.list);h("Template rendering complete")},renderFailure:function(n){var t=qq.toElement(n);o.innerHTML="";o.appendChild(t)},reset:function(){this.render()},clearFiles:function(){l.innerHTML=""},disableCancel:function(){g=!0},addFile:function(n,i,f){var e=qq.toElement(nt.fileTemplate),o=r(e,t.file);qq(e).addClass(ot+n);o&&qq(o).setText(i);e.setAttribute(d,n);f?gt(e,f.index):l.appendChild(e);u(w(n));u(at(n));u(rt(n));u(ni(n));u(p(n));u(it(n));g&&this.hideCancel(n)},removeFile:function(n){qq(f(n)).remove()},getFileId:function(n){var t=n;if(t){while(t.getAttribute(d)==null)t=t.parentNode;return parseInt(t.getAttribute(d))}},getFileList:function(){return l},markFilenameEditable:function(n){var t=k(n);t&&qq(t).addClass(i.classes.editable)},updateFilename:function(n,t){var i=k(n);i&&qq(i).setText(t)},hideFilename:function(n){u(k(n))},showFilename:function(n){e(k(n))},isFileName:function(n){return qq(n).hasClass(t.file)},getButton:function(){return i.button||r(o,t.button)},hideDropProcessing:function(){u(ut())},showDropProcessing:function(){e(ut())},getDropZone:function(){return r(o,t.drop)},isEditFilenamePossible:function(){return st},isRetryPossible:function(){return ht},getFileContainer:function(n){return f(n)},showEditIcon:function(n){var t=lt(n);t&&qq(t).addClass(i.classes.editable)},hideEditIcon:function(n){var t=lt(n);t&&qq(t).removeClass(i.classes.editable)},isEditIcon:function(n){return qq(n).hasClass(t.editNameIcon)},getEditInput:function(n){return r(f(n),t.editFilenameInput)},isEditInput:function(n){return qq(n).hasClass(t.editFilenameInput)},updateProgress:function(n,t,i){var r=w(n),f;r&&(f=Math.round(t/i*100),t===i?u(r):e(r),yt(n,f))},hideProgress:function(n){var t=w(n);t&&u(t)},resetProgress:function(n){yt(n,0)},showCancel:function(n){if(!g){var t=ct(n);t&&qq(t).removeClass(i.classes.hide)}},hideCancel:function(n){u(ct(n))},isCancel:function(n){return qq(n).hasClass(t.cancel)},allowPause:function(n){e(p(n));u(it(n))},uploadPaused:function(n){this.setStatusText(n,i.text.paused);this.allowContinueButton(n);u(b(n))},hidePause:function(n){u(p(n))},isPause:function(n){return qq(n).hasClass(t.pause)},isContinueButton:function(n){return qq(n).hasClass(t.continueButton)},allowContinueButton:function(n){e(it(n));u(p(n))},uploadContinued:function(n){this.setStatusText(n,"");this.allowPause(n);e(b(n))},showDeleteButton:function(n){e(rt(n))},hideDeleteButton:function(n){u(rt(n))},isDeleteButton:function(n){return qq(n).hasClass(t.deleteButton)},isRetry:function(n){return qq(n).hasClass(t.retry)},updateSize:function(n,t){var i=at(n);i&&(e(i),qq(i).setText(t))},setStatusText:function(n,i){var u=r(f(n),t.statusText);u&&(i==null?qq(u).clearText():qq(u).setText(i))},hideSpinner:function(n){u(b(n))},showSpinner:function(n){e(b(n))},generatePreview:function(n,t){var r=vt(n),u={maxSize:s,scale:!0,orient:!0};if(qq.supportedFeatures.imagePreviews){if(c[n]=new qq.Promise,r)return ft(r),i.imageGenerator.generate(t,r,u).then(function(){e(r);c[n].success()},function(){c[n].failure();i.placeholders.waitUntilUpdate||et(n,r)})}else r&&ft(r)},updateThumbnail:function(n,t,r){var u=vt(n),f={maxSize:s,scale:tt};if(u){if(t)return r&&ft(u),i.imageGenerator.generate(t,u,f).then(function(){e(u)},function(){et(n,u)});et(n,u)}}})};qq.UploadHandlerForm=function(n,t){"use strict";function c(n,t){var f,e,u;try{e=t.contentDocument||t.contentWindow.document;u=e.body.innerHTML;i("converting iframe's innerHTML to JSON");i("innerHTML = "+u);u&&u.match(/^<pre/i)&&(u=e.body.firstChild.firstChild.nodeValue);f=r.parseJsonResponse(n,u)}catch(o){i("Error when attempting to parse form upload response ("+o.message+")","error");f={success:!1}}return f}function l(t,i){var f=n.paramsStore.getParams(t),o=n.demoMode?"GET":"POST",s=n.endpointStore.getEndpoint(t),h=u(t);return f[n.uuidName]=e(t),f[n.filenameParam]=h,r.initFormForUpload({method:o,endpoint:s,params:f,paramsInBody:n.paramsInBody,targetName:i.name})}var f=[],o=t.onUploadComplete,s=t.onUuidChanged,u=t.getName,e=t.getUuid,h=o,i=t.log,r={};qq.extend(this,new qq.UploadHandlerFormApi(r,{fileState:f,isCors:n.cors.expected,inputName:n.inputName},{onCancel:n.onCancel,onUuidChanged:s,getName:u,getUuid:e,log:i}));qq.extend(this,{upload:function(t){var s=f[t].input,a=u(t),e=r.createIframe(t),o;if(!s)throw new Error("file with passed id was not added, or already uploaded or canceled");n.onUpload(t,u(t));o=l(t,e);o.appendChild(s);r.attachLoadEvent(e,function(u){i("iframe loaded");var f=u?u:c(t,e);if(r.detachLoadEvent(t),n.cors.expected||qq(e).remove(),f.success||!n.onAutoRetry(t,a,f)){n.onComplete(t,a,f);h(t)}});i("Sending upload request for "+t);o.submit();qq(o).remove()}})};qq.UploadHandlerXhr=function(n,t){"use strict";function et(){if(n.resume.id!==null&&n.resume.id!==undefined&&!qq.isFunction(n.resume.id)&&!qq.isObject(n.resume.id))return n.resume.id}function ot(t,i,r){var u=o(t),e=f(t);i[n.chunking.paramNames.partIndex]=r.part;i[n.chunking.paramNames.partByteOffset]=r.start;i[n.chunking.paramNames.chunkSize]=r.size;i[n.chunking.paramNames.totalParts]=r.count;i[n.totalFileSizeName]=u;h&&(i[n.filenameParam]=e)}function st(t){t[n.resume.paramNames.resuming]=!0}function g(t,i,r,u){var e=new FormData,a=n.demoMode?"GET":"POST",s=n.endpointStore.getEndpoint(u),c=s,l=f(u),v=o(u);return(t[n.uuidName]=y(u),t[n.filenameParam]=l,h&&(t[n.totalFileSizeName]=v),n.paramsInBody||(h||(t[n.inputName]=l),c=qq.obj2url(t,s)),i.open(a,c,!0),n.cors.expected&&n.cors.sendCredentials&&(i.withCredentials=!0),h)?(n.paramsInBody&&qq.obj2FormData(t,e),e.append(n.inputName,r),e):r}function nt(t,r){var u=n.customHeaders,f=i[t].file||i[t].blobData.blob;r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.setRequestHeader("Cache-Control","no-cache");h||(r.setRequestHeader("Content-Type","application/octet-stream"),r.setRequestHeader("X-Mime-Type",f.type));qq.each(u,function(n,t){r.setRequestHeader(n,t)})}function p(t,r,u){var e=f(t),s=o(t);i[t].attemptingResume=!1;n.onProgress(t,e,s,s);n.onComplete(t,e,r,u);i[t]&&delete i[t].xhr;ft(t)}function w(t){var l=i[t].remainingChunkIdxs[0],r=e.getChunkData(t,l),h=e.createXhr(t),y=o(t),a=f(t),v,c;i[t].loaded===undefined&&(i[t].loaded=0);s&&i[t].file&&bt(t,r);h.onreadystatechange=it(t,h);h.upload.onprogress=function(r){if(r.lengthComputable){var u=r.loaded+i[t].loaded,f=ht(t,l,r.total);n.onProgress(t,a,u,f)}};n.onUploadChunk(t,a,e.getChunkDataForCallback(r));c=n.paramsStore.getParams(t);ot(t,c,r);i[t].attemptingResume&&st(c);v=g(c,h,r.blob,t);nt(t,h);u("Sending chunked upload request for item "+t+": bytes "+(r.start+1)+"-"+r.end+" of "+y);h.send(v)}function ht(n,t,r){var f=e.getChunkData(n,t),s=f.size,u=r-s,h=o(n),c=f.count,l=i[n].initialRequestOverhead,a=u-l;return i[n].lastRequestOverhead=u,t===0?(i[n].lastChunkIdxProgress=0,i[n].initialRequestOverhead=u,i[n].estTotalRequestsSize=h+c*u):i[n].lastChunkIdxProgress!==t&&(i[n].lastChunkIdxProgress=t,i[n].estTotalRequestsSize+=a),i[n].estTotalRequestsSize}function ct(n){return h?i[n].lastRequestOverhead:0}function lt(t,r,u){var o=i[t].remainingChunkIdxs.shift(),f=e.getChunkData(t,o);i[t].attemptingResume=!1;i[t].loaded+=f.size+ct(t);n.onUploadChunkSuccess(t,e.getChunkDataForCallback(f),r,u);i[t].remainingChunkIdxs.length>0?w(t):(s&&b(t),p(t,r,u))}function at(n,t){return n.status!==200||!t.success||t.reset}function vt(n,t){var i;try{u(qq.format("Received response status {} with body: {}",t.status,t.responseText));i=qq.parseJson(t.responseText);i.newUuid!==undefined&&v(n,i.newUuid)}catch(r){u("Error when attempting to parse xhr response text ("+r.message+")","error");i={}}return i}function tt(n){u("Server has ordered chunking effort to be restarted on next attempt for item ID "+n,"error");s&&(b(n),i[n].attemptingResume=!1);i[n].remainingChunkIdxs=[];delete i[n].loaded;delete i[n].estTotalRequestsSize;delete i[n].initialRequestOverhead}function yt(n){i[n].attemptingResume=!1;u("Server has declared that it cannot handle resume for item ID "+n+" - starting from the first chunk","error");tt(n);d.upload(n,!0)}function pt(t,i,r){var u=f(t);n.onAutoRetry(t,u,i,r)||p(t,i,r)}function wt(n,t){var f=i[n],e=f&&f.attemptingResume,o=f&&f.paused,r;f&&!o&&(u("xhr - server response received for "+n),u("responseText = "+t.responseText),r=vt(n,t),at(t,r)?(r.reset&&tt(n),e&&r.reset?yt(n):pt(n,r,t)):c?lt(n,r,t):p(n,r,t))}function it(n,t){return function(){t.readyState===4&&wt(n,t)}}function bt(t,u){var f=y(t),e=i[t].loaded,o=i[t].initialRequestOverhead,s=i[t].estTotalRequestsSize,h=k(t),c=f+r+u.part+r+e+r+o+r+s,l=n.resume.cookiesExpireIn;qq.setCookie(h,c,l)}function b(n){if(i[n].file){var t=k(n);qq.deleteCookie(t)}}function rt(n){var i=qq.getCookie(k(n)),l=f(n),t,e,o,s,h,c;if(i){if(t=i.split(r),t.length===5)return e=t[0],o=parseInt(t[1],10),s=parseInt(t[2],10),h=parseInt(t[3],10),c=parseInt(t[4],10),{uuid:e,part:o,lastByteSent:s,initialRequestOverhead:h,estTotalRequestsSize:c};u("Ignoring previously stored resume/chunk cookie for "+l+" - old cookie format","warn")}}function k(t){var u=f(t),e=o(t),s=n.chunking.partSize,i;return i="qqfilechunk"+r+encodeURIComponent(u)+r+e+r+s,l!==undefined&&(i+=r+l),i}function a(n,t){for(var r=e.getTotalChunks(n)-1;r>=t;r-=1)i[n].remainingChunkIdxs.unshift(r);w(n)}function ut(n,t,r,f){r=f.part;i[n].loaded=f.lastByteSent;i[n].estTotalRequestsSize=f.estTotalRequestsSize;i[n].initialRequestOverhead=f.initialRequestOverhead;i[n].attemptingResume=!0;u("Resuming "+t+" at partition index "+r);a(n,r)}function kt(t,i,r){var s=f(t),h=e.getChunkData(t,i.part),o;o=n.onResume(t,s,e.getChunkDataForCallback(h));o instanceof qq.Promise?(u("Waiting for onResume promise to be fulfilled for "+t),o.then(function(){ut(t,s,r,i)},function(){u("onResume promise fulfilled - failure indicated.  Will not resume.");a(t,r)})):o!==!1?ut(t,s,r,i):(u("onResume callback returned false.  Will not resume."),a(t,r))}function dt(n,t){var r=0,u;i[n].remainingChunkIdxs&&i[n].remainingChunkIdxs.length!==0?w(n):(i[n].remainingChunkIdxs=[],s&&!t&&i[n].file?(u=rt(n),u?kt(n,u,r):a(n,r)):a(n,r))}function gt(t){var h=i[t].file||i[t].blobData.blob,c=f(t),r,o,s;i[t].loaded=0;r=e.createXhr(t);r.upload.onprogress=function(r){if(r.lengthComputable){i[t].loaded=r.loaded;n.onProgress(t,c,r.loaded,r.total)}};r.onreadystatechange=it(t,r);o=n.paramsStore.getParams(t);s=g(o,r,h,t);nt(t,r);u("Sending upload request for "+t);r.send(s)}function ni(t,i){var r=f(t);if(d.isValid(t)){n.onUpload(t,r);c?dt(t,i):gt(t)}}var ft=t.onUploadComplete,v=t.onUuidChanged,f=t.getName,y=t.getUuid,o=t.getSize,u=t.log,i=[],r="|",c=n.chunking.enabled&&qq.supportedFeatures.chunking,s=n.resume.enabled&&c&&qq.supportedFeatures.resume,h=n.forceMultipart||n.paramsInBody,e={},d=this,l;l=et();qq.extend(this,new qq.UploadHandlerXhrApi(e,{fileState:i,chunking:c?n.chunking:null},{onUpload:ni,onCancel:n.onCancel,onUuidChanged:v,getName:f,getSize:o,getUuid:y,log:u}));qq.override(this,function(t){return{add:function(n){var i;return t.add.apply(this,arguments),s&&(i=rt(n),i&&v(n,i.uuid)),n},getResumableFilesData:function(){var t=[],i=[];return c&&s?(t=l===undefined?qq.getCookieNames(new RegExp("^qqfilechunk\\"+r+".+\\"+r+"\\d+\\"+r+n.chunking.partSize+"=")):qq.getCookieNames(new RegExp("^qqfilechunk\\"+r+".+\\"+r+"\\d+\\"+r+n.chunking.partSize+"\\"+r+l+"=")),qq.each(t,function(n,t){var u=t.split(r),f=qq.getCookie(t).split(r);i.push({name:decodeURIComponent(u[1]),size:u[2],uuid:f[0],partIdx:f[1]})}),i):[]},expunge:function(n){s&&b(n);t.expunge(n)}}})};qq.PasteSupport=function(n){"use strict";function r(n){return n.type&&n.type.indexOf("image/")===0}function u(){qq(t.targetElement).attach("paste",function(n){var i=n.clipboardData;i&&qq.each(i.items,function(n,i){if(r(i)){var u=i.getAsFile();t.callbacks.pasteReceived(u)}})})}function f(){i&&i()}var t,i;t={targetElement:null,callbacks:{log:function(){},pasteReceived:function(){}}};qq.extend(t,n);u();qq.extend(this,{reset:function(){f()}})};qq.DragAndDrop=function(n){"use strict";function h(n,i){var r=Array.prototype.slice.call(n);t.callbacks.dropLog("Grabbed "+n.length+" dropped files.");i.dropDisabled(!1);t.callbacks.processingDroppedFilesComplete(r,i.getElement())}function o(n){var u,i=new qq.Promise;return n.isFile?n.file(function(n){r.push(n);i.success()},function(r){t.callbacks.dropLog("Problem parsing '"+n.fullPath+"'.  FileError code "+r.code+".","error");i.failure()}):n.isDirectory&&(u=n.createReader(),u.readEntries(function(n){var t=n.length;qq.each(n,function(n,r){o(r).done(function(){t-=1;t===0&&i.success()})});n.length||i.success()},function(r){t.callbacks.dropLog("Problem parsing '"+n.fullPath+"'.  FileError code "+r.code+".","error");i.failure()})),i}function c(n,i){var u=[],f=new qq.Promise;return t.callbacks.processingDroppedFiles(),i.dropDisabled(!0),n.files.length>1&&!t.allowMultipleItems?(t.callbacks.processingDroppedFilesComplete([]),t.callbacks.dropError("tooManyFilesError",""),i.dropDisabled(!1),f.failure()):(r=[],qq.isFolderDropSupported(n)?qq.each(n.items,function(n,t){var i=t.webkitGetAsEntry();i&&(i.isFile?r.push(t.getAsFile()):u.push(o(i).done(function(){u.pop();u.length===0&&f.success()})))}):r=n.files,u.length===0&&f.success()),f}function s(n){var o=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:f,element:n,onEnter:function(i){qq(n).addClass(t.classes.dropActive);i.stopPropagation()},onLeaveNotDescendants:function(){qq(n).removeClass(t.classes.dropActive)},onDrop:function(n){c(n.dataTransfer,o).done(function(){h(r,o)})}});return i.addDisposer(function(){o.dispose()}),qq(n).hasAttribute(u)&&qq(n).hide(),e.push(o),o}function l(n){var t;return qq.each(n.dataTransfer.types,function(n,i){if(i==="Files")return t=!0,!1}),t}function a(n){return(qq.chrome()||qq.safari()&&qq.windows())&&n.clientX==0&&n.clientY==0||qq.firefox()&&!n.relatedTarget}function v(){var n=t.dropZoneElements;qq.each(n,function(t,r){var u=s(r);n.length&&(!qq.ie()||qq.ie10())&&i.attach(document,"dragenter",function(t){!u.dropDisabled()&&l(t)&&qq.each(n,function(n,t){t instanceof HTMLElement&&qq(t).css({display:"block"})})})});i.attach(document,"dragleave",function(t){a(t)&&qq.each(n,function(n,t){qq(t).hasAttribute(u)&&qq(t).hide()})});i.attach(document,"drop",function(t){qq.each(n,function(n,t){qq(t).hasAttribute(u)&&qq(t).hide()});t.preventDefault()});i.attach(document,f,function(){qq.each(t.dropZoneElements,function(n,i){qq(i).hasAttribute(u)&&qq(i).hide();qq(i).removeClass(t.classes.dropActive)})})}var t,f="qq-hidezones",u="qq-hide-dropzone",e=[],r=[],i=new qq.DisposeSupport;t={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks};qq.extend(t,n,!0);v();qq.extend(this,{setupExtraDropzone:function(n){t.dropZoneElements.push(n);s(n)},removeDropzone:function(n){var i,r=t.dropZoneElements;for(i in r)if(r[i]===n)return r.splice(i,1)},dispose:function(){i.dispose();qq.each(e,function(n,t){t.dispose()})}})};qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(){},dropError:function(n,t){qq.log("Drag & drop error code '"+n+" with these specifics: '"+t+"'","error")},dropLog:function(n,t){qq.log(n,t)}}};qq.UploadDropZone=function(n){"use strict";function s(){return qq.safari()||qq.firefox()&&qq.windows()}function h(){o||(s?i.attach(document,"dragover",function(n){n.preventDefault()}):i.attach(document,"dragover",function(n){n.dataTransfer&&(n.dataTransfer.dropEffect="none",n.preventDefault())}),o=!0)}function u(n){if(qq.ie()&&!qq.ie10())return!1;var i,t=n.dataTransfer,r=qq.safari();return i=qq.ie10()||qq.ie11()?!0:t.effectAllowed!=="none",t&&i&&(t.files||!r&&t.types.contains&&t.types.contains("Files"))}function f(n){return n!==undefined&&(e=n),e}function c(){function i(){n=document.createEvent("Event");n.initEvent(t.HIDE_ZONES_EVENT_NAME,!0,!0)}var n;if(window.CustomEvent)try{n=new CustomEvent(t.HIDE_ZONES_EVENT_NAME)}catch(r){i()}else i();document.dispatchEvent(n)}function l(){i.attach(r,"dragover",function(n){if(u(n)){var t=qq.ie()||qq.ie11()?null:n.dataTransfer.effectAllowed;n.dataTransfer.dropEffect=t==="move"||t==="linkMove"?"move":"copy";n.stopPropagation();n.preventDefault()}});i.attach(r,"dragenter",function(n){if(!f()){if(!u(n))return;t.onEnter(n)}});i.attach(r,"dragleave",function(n){if(u(n)){t.onLeave(n);var i=document.elementFromPoint(n.clientX,n.clientY);if(!qq(this).contains(i))t.onLeaveNotDescendants(n)}});i.attach(r,"drop",function(n){if(!f()){if(!u(n))return;n.preventDefault();n.stopPropagation();t.onDrop(n);c()}})}var i=new qq.DisposeSupport,t,r,e,o;t={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}};qq.extend(t,n);r=t.element;h();l();qq.extend(this,{dropDisabled:function(n){return f(n)},dispose:function(){i.dispose()},getElement:function(){return r}})};qq.DeleteFileAjaxRequester=function(n){"use strict";function r(){return t.method.toUpperCase()==="POST"?{_method:"DELETE"}:{}}var i,t={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};qq.extend(t,n);i=new qq.AjaxRequester({validMethods:["POST","DELETE"],method:t.method,endpointStore:t.endpointStore,paramsStore:t.paramsStore,mandatedParams:r(),maxConnections:t.maxConnections,customHeaders:t.customHeaders,demoMode:t.demoMode,log:t.log,onSend:t.onDelete,onComplete:t.onDeleteComplete,cors:t.cors});qq.extend(this,{sendDelete:function(n,r,u){var f=u||{};t.log("Submitting delete file request for "+n);t.method==="DELETE"?i.initTransport(n).withPath(r).withParams(f).send():(f[t.uuidParamName]=r,i.initTransport(n).withParams(f).send())}})},function(){function i(n){var r=n.naturalWidth,u=n.naturalHeight,t,i;return r*u>1048576?(t=document.createElement("canvas"),t.width=t.height=1,i=t.getContext("2d"),i.drawImage(n,-r+1,0),i.getImageData(0,0,1,1).data[3]===0):!1}function r(n,t,i){var u=document.createElement("canvas"),f,h,o;u.width=1;u.height=i;f=u.getContext("2d");f.drawImage(n,0,0);for(var c=f.getImageData(0,0,1,i).data,e=0,s=i,r=i;r>e;)h=c[(r-1)*4+3],h===0?s=r:e=r,r=s+e>>1;return o=r/i,o===0?1:o}function u(n,i,r){var u=document.createElement("canvas"),f=i.mime||"image/jpeg";return t(n,u,i,r),u.toDataURL(f,i.quality||.8)}function t(n,t,u,e){var h=n.naturalWidth,c=n.naturalHeight,v=u.width,y=u.height,l=t.getContext("2d"),k,o,s,a,b;if(l.save(),f(t,v,y,u.orientation),qq.ios()){k=i(n);k&&(h/=2,c/=2);o=1024;s=document.createElement("canvas");s.width=s.height=o;for(var p=s.getContext("2d"),tt=e?r(n,h,c):1,d=Math.ceil(o*v/h),g=Math.ceil(o*y/c/tt),w=0,nt=0;w<c;){for(a=0,b=0;a<h;)p.clearRect(0,0,o,o),p.drawImage(n,-a,-w),l.drawImage(s,0,0,o,o,b,nt,d,g),a+=o,b+=d;w+=o;nt+=g}l.restore();s=p=null}else l.drawImage(n,0,0,v,y)}function f(n,t,i,r){switch(r){case 5:case 6:case 7:case 8:n.width=i;n.height=t;break;default:n.width=t;n.height=i}var u=n.getContext("2d");switch(r){case 2:u.translate(t,0);u.scale(-1,1);break;case 3:u.translate(t,i);u.rotate(Math.PI);break;case 4:u.translate(0,i);u.scale(1,-1);break;case 5:u.rotate(.5*Math.PI);u.scale(1,-1);break;case 6:u.rotate(.5*Math.PI);u.translate(0,-i);break;case 7:u.rotate(.5*Math.PI);u.translate(t,-i);u.scale(-1,1);break;case 8:u.rotate(-.5*Math.PI);u.translate(-t,0)}}function n(n,t){var i,r,u;if(window.Blob&&n instanceof Blob){if(i=new Image,r=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null,!r)throw Error("No createObjectURL function found to create blob url");i.src=r.createObjectURL(n);this.blob=n;n=i}n.naturalWidth||n.naturalHeight||(u=this,n.onload=function(){var t=u.imageLoadListeners,n,i;if(t)for(u.imageLoadListeners=null,n=0,i=t.length;n<i;n++)t[n]()},n.onerror=t,this.imageLoadListeners=[]);this.srcImage=n}n.prototype.render=function(n,i){var v,s,l,a;if(this.imageLoadListeners){v=this;this.imageLoadListeners.push(function(){v.render(n,i)});return}i=i||{};var e=this.srcImage.naturalWidth,o=this.srcImage.naturalHeight,r=i.width,f=i.height,h=i.maxWidth,c=i.maxHeight,y=!this.blob||this.blob.type==="image/jpeg";r&&!f?f=o*r/e<<0:f&&!r?r=e*f/o<<0:(r=e,f=o);h&&r>h&&(r=h,f=o*r/e<<0);c&&f>c&&(f=c,r=e*f/o<<0);s={width:r,height:f};for(l in i)s[l]=i[l];if(a=n.tagName.toLowerCase(),a==="img"?n.src=u(this.srcImage,s,y):a==="canvas"&&t(this.srcImage,n,s,y),typeof this.onrender=="function")this.onrender(n)};typeof define=="function"&&define.amd?define([],function(){return n}):this.MegaPixImage=n}();qq.ImageGenerator=function(n){"use strict";function i(n){return n.tagName.toLowerCase()==="img"}function r(n){return n.tagName.toLowerCase()==="canvas"}function s(){return(new Image).crossOrigin!==undefined}function h(){var n=document.createElement("canvas");return n.getContext&&n.getContext("2d")}function f(n){var i=n.split("/"),r=i[i.length-1],t=qq.getExtension(r);t=t&&t.toLowerCase();switch(t){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function u(n){var t=document.createElement("a"),i,r,u;return(t.href=n,i=t.protocol,u=t.port,r=t.hostname,i.toLowerCase()!==window.location.protocol.toLowerCase())?!0:r.toLowerCase()!==window.location.hostname.toLowerCase()?!0:u!==window.location.port&&!qq.ie()?!0:!1}function c(t,i){t.onload=function(){t.onload=null;t.onerror=null;i.success(t)};t.onerror=function(){t.onload=null;t.onerror=null;n("Problem drawing thumbnail!","error");i.failure(t,"Problem drawing thumbnail!")}}function l(n,t){var i=n.getContext("2d"),r=i.drawImage;i.drawImage=function(){r.apply(this,arguments);t.success(n);i.drawImage=r}}function t(t,u){var f=i(t)||r(t);return i(t)?c(t,u):r(t)?l(t,u):(u.failure(t),n(qq.format("Element container of type {} is not supported!",t.tagName),"error")),f}function a(i,r,u){var f=new qq.Promise,o=new qq.Identify(i,n),e=u.maxSize,s=function(){r.onerror=null;r.onload=null;n("Could not render preview, file may be too large!","error");f.failure(r,"Browser cannot render image!")};return o.isPreviewable().then(function(u){var h=new qq.Exif(i,n),o=new MegaPixImage(i,s);t(r,f)&&h.parse().then(function(n){var t=n.Orientation;o.render(r,{maxWidth:e,maxHeight:e,orientation:t,mime:u})},function(t){n(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",t));o.render(r,{maxWidth:e,maxHeight:e,mime:u})})},function(){n("Not previewable");f.failure(r,"Not previewable")}),f}function e(n,i,r,e){var o=new Image,s=new qq.Promise;t(o,s);u(n)&&(o.crossOrigin="anonymous");o.src=n;s.then(function(){t(i,r);var u=new MegaPixImage(o);u.render(i,{maxWidth:e,maxHeight:e,mime:f(n)})})}function o(n,i,r,u){t(i,r);qq(i).css({maxWidth:u+"px",maxHeight:u+"px"});i.src=n}function v(n,f,c){var l=new qq.Promise,v=c.scale,a=v?c.maxSize:null;return v&&i(f)?h()?u(n)&&!s()?o(n,f,l,a):e(n,f,l,a):o(n,f,l,a):r(f)?e(n,f,l,a):t(f,l)&&(f.src=n),l}qq.extend(this,{generate:function(t,i,r){return qq.isString(t)?(n("Attempting to update thumbnail based on server response."),v(t,i,r||{})):(n("Attempting to draw client-side image preview."),a(t,i,r||{}))}});this._testing={};this._testing.isImg=i;this._testing.isCanvas=r;this._testing.isCrossOrigin=u;this._testing.determineMimeOfFileName=f};qq.Exif=function(n,t){"use strict";function i(n){for(var t=0,i=0;n.length>0;)t+=parseInt(n.substring(0,2),16)*Math.pow(2,i),n=n.substring(2,n.length),i+=8;return t}function u(t,i){var r=t,f=i;return r===undefined&&(r=2,f=new qq.Promise),qq.readBlobToHex(n,r,4).then(function(n){var t=/^ffe([0-9])/.exec(n),i;t?t[1]!=="1"?(i=parseInt(n.slice(4,8),16),u(r+i+2,f)):f.success(r):f.failure("No EXIF header to be found!")}),f}function e(){var t=new qq.Promise;return qq.readBlobToHex(n,0,6).then(function(n){n.indexOf("ffd8")!==0?t.failure("Not a valid JPEG!"):u().then(function(n){t.success(n)},function(n){t.failure(n)})}),t}function o(t){var i=new qq.Promise;return qq.readBlobToHex(n,t+10,2).then(function(n){i.success(n==="4949")}),i}function s(t,r){var u=new qq.Promise;return qq.readBlobToHex(n,t+18,2).then(function(n){if(r)return u.success(i(n));u.success(parseInt(n,16))}),u}function h(t,i){var r=t+20,u=i*12;return qq.readBlobToHex(n,r,u)}function c(n){for(var i=[],t=0;t+24<=n.length;)i.push(n.slice(t,t+24)),t+=24;return i}function l(n,t){var e=16,u=qq.extend([],f),o={};return qq.each(t,function(t,f){var c=f.slice(0,4),s=n?i(c):parseInt(c,16),l=u.indexOf(s),h,a,v;return l>=0&&(a=r[s].name,v=r[s].bytes,h=f.slice(e,e+v*2),o[a]=n?i(h):parseInt(h,16),u.splice(l,1)),u.length===0?!1:void 0}),o}var f=[274],r={274:{name:"Orientation",bytes:2}};qq.extend(this,{parse:function(){var r=new qq.Promise,i=function(n){t(qq.format("EXIF header parse failed: '{}' ",n));r.failure(n)};return e().then(function(u){t(qq.format("Moving forward with EXIF header parsing for '{}'",n.name===undefined?"blob":n.name));o(u).then(function(n){t(qq.format("EXIF Byte order is {} endian",n?"little":"big"));s(u,n).then(function(f){t(qq.format("Found {} APP1 directory entries",f));h(u,f).then(function(i){var u=c(i),f=l(n,u);t("Successfully parsed some EXIF tags");r.success(f)},i)},i)},i)},i),r}});this._testing={};this._testing.parseLittleEndian=i};qq.Identify=function(n,t){"use strict";function r(n,t){var i=!1,r=[].concat(n);return qq.each(r,function(n,r){if(t.indexOf(r)===0)return i=!0,!1}),i}var i={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]};qq.extend(this,{isPreviewable:function(){var u=new qq.Promise,f=!1,e=n.name===undefined?"blob":n.name;return t(qq.format("Attempting to determine if {} can be rendered in this browser",e)),qq.readBlobToHex(n,0,4).then(function(n){qq.each(i,function(t,i){if(r(i,n))return(t!=="image/tiff"||qq.safari())&&(f=!0,u.success(t)),!1});t(qq.format("'{}' is {} able to be rendered in this browser",e,f?"":"NOT"));f||u.failure()}),u}})};qq.ImageValidation=function(n,t){"use strict";function i(n){var t=!1;return qq.each(n,function(n,i){if(i>0)return t=!0,!1}),t}function r(){var i=new qq.Promise;return new qq.Identify(n,t).isPreviewable().then(function(){var r=new Image,u=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;u?(r.onerror=function(){t("Cannot determine dimensions for image.  May be too large.","error");i.failure()},r.onload=function(){i.success({width:this.width,height:this.height})},r.src=u.createObjectURL(n)):(t("No createObjectURL function available to generate image URL!","error"),i.failure())},i.failure),i}function u(n,t){var i;return qq.each(n,function(n,r){if(r>0){var u=/(max|min)(Width|Height)/.exec(n),e=u[2].charAt(0).toLowerCase()+u[2].slice(1),f=t[e];switch(u[1]){case"min":if(f<r)return i=n,!1;break;case"max":if(f>r)return i=n,!1}}}),i}this.validate=function(n){var f=new qq.Promise;return t("Attempting to validate image."),i(n)?r().then(function(t){var i=u(n,t);i?f.failure(i):f.success()},f.success):f.success(),f}};qq.Session=function(n){"use strict";function i(n){if(qq.isArray(n))return!0;t.log("Session response is not an array.","error")}function r(n,r,u,f){var e=!1;r=r&&i(n);r&&qq.each(n,function(n,i){if(i.uuid==null)e=!0,t.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",n),"error");else if(i.name==null)e=!0,t.log(qq.format("Session response item {} did not include a valid name - ignoring.",n),"error");else try{return t.addFileRecord(i),!0}catch(r){e=!0;t.log(r.message,"error")}return!1});f[r&&!e?"success":"failure"](n,u)}var t={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(){},log:function(){}};qq.extend(t,n,!0);this.refresh=function(){var n=new qq.Promise,i=function(t,i,u){r(t,i,u,n)},u=qq.extend({},t),f=new qq.SessionAjaxRequester(qq.extend(u,{onComplete:i}));return f.queryServer(),n}};qq.SessionAjaxRequester=function(n){"use strict";function r(n,i,r){var u=null;if(i.responseText!=null)try{u=qq.parseJson(i.responseText)}catch(f){t.log("Problem parsing session response: "+f.message,"error");r=!0}t.onComplete(u,!r,i)}var i,t={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(){},log:function(){}};qq.extend(t,n);i=new qq.AjaxRequester({validMethods:["GET"],method:"GET",endpointStore:{getEndpoint:function(){return t.endpoint}},customHeaders:t.customHeaders,log:t.log,onComplete:r,cors:t.cors});qq.extend(this,{queryServer:function(){var n=qq.extend({},t.params);n.qqtimestamp=(new Date).getTime();t.log("Session query request.");i.initTransport("sessionRefresh").withParams(n).send()}})};qq.UiEventHandler=function(n,t){"use strict";function u(n){r.attach(n,i.eventType,function(n){n=n||window.event;var t=n.target||n.srcElement;i.onHandled(t,n)})}var r=new qq.DisposeSupport,i={eventType:"click",attachTo:null,onHandled:function(){}};qq.extend(this,{addHandler:function(n){u(n)},dispose:function(){r.dispose()}});qq.extend(t,{getFileIdFromItem:function(n){return n.qqFileId},getDisposeSupport:function(){return r}});qq.extend(i,n);i.attachTo&&u(i.attachTo)};qq.FileButtonsClickHandler=function(n){"use strict";function r(n,r){qq.each(i,function(i,u){var e=i.charAt(0).toUpperCase()+i.slice(1),f;if(t.templating["is"+e](n))return f=t.templating.getFileId(n),qq.preventDefault(r),t.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",t.onGetName(f),f)),u(f),!1})}var t={templating:null,log:function(){},onDeleteFile:function(){},onCancel:function(){},onRetry:function(){},onPause:function(){},onContinue:function(){},onGetName:function(){}},i={cancel:function(n){t.onCancel(n)},retry:function(n){t.onRetry(n)},deleteButton:function(n){t.onDeleteFile(n)},pause:function(n){t.onPause(n)},continueButton:function(n){t.onContinue(n)}};qq.extend(t,n);t.eventType="click";t.onHandled=r;t.attachTo=t.templating.getFileList();qq.extend(this,new qq.UiEventHandler(t,{}))};qq.FilenameClickHandler=function(n){"use strict";function r(n,r){if(t.templating.isFileName(n)||t.templating.isEditIcon(n)){var u=t.templating.getFileId(n),f=t.onGetUploadStatus(u);f===qq.status.SUBMITTED&&(t.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",t.onGetName(u),u)),qq.preventDefault(r),i.handleFilenameEdit(u,n,!0))}}var i={},t={templating:null,log:function(){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(){},onGetName:function(){}};qq.extend(t,n);t.eventType="click";t.onHandled=r;qq.extend(this,new qq.FilenameEditHandler(t,i))};qq.FilenameInputFocusInHandler=function(n,t){"use strict";function r(n){if(i.templating.isEditInput(n)){var r=i.templating.getFileId(n),u=i.onGetUploadStatus(r);u===qq.status.SUBMITTED&&(i.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",i.onGetName(r),r)),t.handleFilenameEdit(r,n))}}var i={templating:null,onGetUploadStatus:function(){},log:function(){}};t||(t={});i.eventType="focusin";i.onHandled=r;qq.extend(i,n);qq.extend(this,new qq.FilenameEditHandler(i,t))};qq.FilenameInputFocusHandler=function(n){"use strict";n.eventType="focus";n.attachTo=null;qq.extend(this,new qq.FilenameInputFocusInHandler(n,{}))};qq.FilenameEditHandler=function(n,t){"use strict";function u(n){var t=i.onGetName(n),r=t.lastIndexOf(".");return r>0&&(t=t.substr(0,r)),t}function f(n){var t=i.onGetName(n);return qq.getExtension(t)}function r(n,t){var r=n.value,u;if(r!==undefined&&qq.trimStr(r).length>0){u=f(t);u!==undefined&&(r=r+"."+u);i.onSetName(t,r)}i.onEditingStatusChange(t,!1)}function e(n,i){t.getDisposeSupport().attach(n,"blur",function(){r(n,i)})}function o(n,i){t.getDisposeSupport().attach(n,"keyup",function(t){var u=t.keyCode||t.which;u===13&&r(n,i)})}var i={templating:null,log:function(){},onGetUploadStatus:function(){},onGetName:function(){},onSetName:function(){},onEditingStatusChange:function(){}};qq.extend(i,n);i.attachTo=i.templating.getFileList();qq.extend(this,new qq.UiEventHandler(i,t));qq.extend(t,{handleFilenameEdit:function(n,t,r){var f=i.templating.getEditInput(n);i.onEditingStatusChange(n,!0);f.value=u(n);r&&f.focus();e(f,n);o(f,n)}})},function(n){"use strict";function s(n){if(n){var u=r(n),f=h(u);i(f);c(u,f)}return t}function h(n){var t=u("uploaderType"),i=u("endpointType");return t?(t=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),i)?new qq[i]["FineUploader"+t](n):new qq["FineUploader"+t](n):i?new qq[i].FineUploader(n):new qq.FineUploader(n)}function f(n,i){var r=t.data("fineuploader");if(i)r===undefined&&(r={}),r[n]=i,t.data("fineuploader",r);else return r===undefined?null:r[n]}function i(n){return f("uploader",n)}function u(n,t){return f(n,t)}function c(i,r){var u=i.callbacks={};n.each(r._options.callbacks,function(i,r){var f,o;f=/^on(\w+)/.exec(i)[1];f=f.substring(0,1).toLowerCase()+f.substring(1);o=t;u[i]=function(){var i=Array.prototype.slice.call(arguments),u=[],t,s;n.each(i,function(n,t){u.push(e(t))});t=r.apply(this,i);try{s=o.triggerHandler(f,u)}catch(h){qq.log("Caught error in Fine Uploader jQuery event handler: "+h.message,"error")}return t!=null?t:s}});r._options.callbacks=u}function r(i,f){var e,s;return e=f===undefined?i.uploaderType!=="basic"?{element:t[0]}:{}:f,n.each(i,function(t,i){n.inArray(t,o)>=0?u(t,i):i instanceof n?e[t]=i[0]:n.isPlainObject(i)?(e[t]={},r(i,e[t])):n.isArray(i)?(s=[],n.each(i,function(t,i){var u={};i instanceof n?n.merge(s,i):n.isPlainObject(i)?(r(i,u),s.push(u)):s.push(i)}),e[t]=s):e[t]=i}),f===undefined?e:void 0}function l(t){return n.type(t)==="string"&&!t.match(/^_/)&&i()[t]!==undefined}function a(n){var t=[],f=Array.prototype.slice.call(arguments,1),u;return r(f,t),u=i()[n].apply(i(),t),e(u)}function e(t){var i=t;return t!=null&&typeof t=="object"&&(t.nodeType===1||t.nodeType===9)&&t.cloneNode&&(i=n(t)),i}var t,o=["uploaderType","endpointType"];n.fn.fineUploader=function(r){var f=this,e=arguments,u=[];return(this.each(function(o,h){if(t=n(h),i()&&l(r)){if(u.push(a.apply(f,e)),f.length===1)return!1}else typeof r!="object"&&r?n.error("Method "+r+" does not exist on jQuery.fineUploader"):s.apply(f,e)}),u.length===1)?u[0]:u.length>1?u:this}}(jQuery),function(n){"use strict";function f(n){n||(n={});n.dropZoneElements=[t];var u=r(n);return o(u),i(new qq.DragAndDrop(u)),t}function e(n,i){var r=t.data(u);if(i)r===undefined&&(r={}),r[n]=i,t.data(u,r);else return r===undefined?null:r[n]}function i(n){return e("dndInstance",n)}function o(i){var r=i.callbacks={},u=new qq.FineUploaderBasic;n.each(new qq.DragAndDrop.callbacks,function(n){var u=n,i;i=t;r[n]=function(){var n=Array.prototype.slice.call(arguments);return i.triggerHandler(u,n)}})}function r(t,i){var u,f;return u=i===undefined?{}:i,n.each(t,function(t,i){i instanceof n?u[t]=i[0]:n.isPlainObject(i)?(u[t]={},r(i,u[t])):n.isArray(i)?(f=[],n.each(i,function(t,i){i instanceof n?n.merge(f,i):f.push(i)}),u[t]=f):u[t]=i}),i===undefined?u:void 0}function s(t){return n.type(t)==="string"&&t==="dispose"&&i()[t]!==undefined}function h(n){var t=[],u=Array.prototype.slice.call(arguments,1);return r(u,t),i()[n].apply(i(),t)}var u="fineUploaderDnd",t;n.fn.fineUploaderDnd=function(r){var e=this,o=arguments,u=[];return(this.each(function(c,l){if(t=n(l),i()&&s(r)){if(u.push(h.apply(e,o)),e.length===1)return!1}else typeof r!="object"&&r?n.error("Method "+r+" does not exist in Fine Uploader's DnD module."):f.apply(e,o)}),u.length===1)?u[0]:u.length>1?u:this}}(jQuery);
/*
//# sourceMappingURL=jquery.fineuploader-4.2.2.min.js.map
*/